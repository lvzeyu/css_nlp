{"version":3,"kind":"Notebook","sha256":"cd227fa49f3618365684de89609a3072838858e587a6f021df3305b6b8faee3b","slug":"word2vec-1","location":"/notebook/word2vec_1.ipynb","dependencies":[],"frontmatter":{"title":"単語分散表現","content_includes_title":false,"kernelspec":{"name":"python3","display_name":"jupyterbook","language":"python"},"github":"https://github.com/lvzeyu/css_nlp","numbering":{"heading_1":{"enabled":true,"template":"enabled"},"heading_2":{"enabled":true,"template":"enabled"},"heading_3":{"enabled":true,"template":"enabled"},"heading_4":{"enabled":true,"template":"enabled"},"heading_5":{"enabled":true,"template":"enabled"},"heading_6":{"enabled":true,"template":"enabled"},"title":{"offset":1}},"source_url":"https://github.com/lvzeyu/css_nlp/blob/master/notebook/word2vec_1.ipynb","edit_url":"https://github.com/lvzeyu/css_nlp/edit/master/notebook/word2vec_1.ipynb","thumbnail":"/build/7e2db436150c38a00650f96925aa5581.svg","exports":[{"format":"ipynb","filename":"word2vec_1.ipynb","url":"/build/word2vec_1-b98f3515aac39d8d8f6c00beaf3500c0.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"link","url":"https://colab.research.google.com/github/lvzeyu/css_nlp/blob/master/notebook/word2vec-1.ipynb","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"image","url":"/build/7e2db436150c38a00650f96925aa5581.svg","alt":"Open In Colab","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"KeFjJbPVPO","urlSource":"https://colab.research.google.com/assets/colab-badge.svg"}],"urlSource":"https://colab.research.google.com/github/lvzeyu/css_nlp/blob/master/notebook/word2vec-1.ipynb","key":"x2hZ2DfqOi"}],"key":"c7wSMQ6ni7"},{"type":"paragraph","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"単語分散表現とは、単語の意味を低次元の実数値ベクトルで表現することです。","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"VQZUV0nGcT"}],"key":"ZMS3HwrBhG"},{"type":"paragraph","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"機械学習・深層学習モデルは、ベクトル（数値の配列）を入力として受け取ります。テキストを扱う際、最初に決めなければならないのは、文字列を機械学習モデルに入力する前に、数値に変換する（あるいはテキストを「ベクトル化」する）ための戦略です。","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"m6TsHf3o47"}],"key":"DLsZThQNmr"},{"type":"paragraph","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"単語の持つ性質や意味をよく反映するベクトル表現を獲得することは、機械学習・深層学習を自然言語処理で活用するために重要なプロセスです。","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"t75H5a49Pq"}],"key":"Wn5Jdfu2Qm"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":12,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"類似性: ある概念を表現する際に、ほかの概念との共通点や類似性と紐づけながら、ベクトル空間上に表現します。","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"Um0D6khQqx"}],"key":"Dy4Or8jznQ"}],"key":"ur3WnvALFx"},{"type":"listItem","spread":true,"position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"単語類推: 分散表現では異なる概念を表現するベクトル同士での計算が可能です","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"VL4JD2uufU"}],"key":"kwHuxgAGHS"}],"key":"MoYWEpfQ34"}],"key":"zvIz1gcdHj"}],"key":"jJkbhl1Aus"},{"type":"block","kind":"notebook-content","children":[{"type":"container","kind":"figure","children":[{"type":"image","url":"/build/word2vec-e9464d85d29ea83b24cfeb53aedc1339.png","alt":"単語分散表現による単語の意味の類似性を表現することができます: 意味的に近い単語（例：cat と kitten）は近い位置に配置されます","width":"600px","align":"center","data":{"altTextIsAutoGenerated":true},"key":"MYHl1tMCSK","urlSource":"./Figure/word2vec.png"},{"type":"caption","children":[{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":7,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"単語分散表現による単語の意味の類似性を表現することができます: 意味的に近い単語（例：cat と kitten）は近い位置に配置されます","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"UNpEMzTPxz"}],"key":"WMjhsJI8ZQ"}],"key":"UxtVDYSKIo"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"単語分散表現による単語類推を行うことができます: man と woman、king と queen のように意味的に対応関係を持つ単語はベクトル差が似た方向を持つため、アナロジー推論（king - man + woman ≈ queen）が可能になります","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"SGcqiTzmcm"}],"key":"J16Y3I7cDl"}],"key":"CVGiVSP5r3"}],"key":"mbmwzbBJK4"}],"key":"nqouVXvYAa"}],"enumerator":"1","key":"sUFGN1sMKf"}],"key":"jfn6aIjT0B"},{"type":"block","kind":"notebook-content","children":[{"type":"container","kind":"figure","children":[{"type":"image","url":"/build/city-e6c77b7ca4a215fa59796ccdb43bdc18.png","alt":"単語分散表現による多次元ベクトル空間において意味や関係を捉えます:","width":"600px","align":"center","data":{"altTextIsAutoGenerated":true},"key":"NK9ATwaDQL","urlSource":"./Figure/city.png"},{"type":"caption","children":[{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"単語分散表現による多次元ベクトル空間において意味や関係を捉えます:","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"qUEes1FIOi"}],"key":"TpnoMbaQpC"}],"key":"SBd89xFWSw"}],"key":"Qx0Nw52ufE"}],"key":"PY4qo8CE2r"}],"enumerator":"2","key":"Bgxs0fSzEH"}],"key":"mLi30bsWUN"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"単語ベクトルへの変換には様々なアプローチが存在します。最初は、(1)統計情報から単語を表現する手法ーカウントベースの手法ーについて説明します。この方法は、言語のモデル化を理解することに役に立つと考られます。そして、(2)ニューラルネットワークを用いた手法(具体的には、word2vecと呼ばれる手法)を扱います。","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"vvZUByNf9z"}],"key":"OXsF66Gwqw"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":4,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"カウントベースの手法","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"bKCD0RFPJi"}],"key":"N6YOChVxC0"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"統計情報から単語を表現する手法","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"BdEP7BeeZO"}],"key":"PuCpREX1od"}],"key":"WXLZzXRF3O"}],"key":"jlpFznpKHz"}],"key":"sbRqu3IjFx"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"推論ベースの手法","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"jq2cOngfFR"}],"key":"GZ0nEGMx2m"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"ニューラルネットワークを用いた手法","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"B8boy0Vi0g"}],"key":"fMmmDmbfq5"}],"key":"Ff8HvtZ9qE"}],"key":"HRRTkOoxkK"}],"key":"RO1lprsq6J"}],"key":"zH87KdW9Vh"}],"key":"mwVNuJHxyA"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"シソーラスによる手法","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"f4QZdBgy7k"}],"identifier":"id","label":"シソーラスによる手法","html_id":"id","implicit":true,"enumerator":"1","key":"z7DakpWw7k"}],"key":"OS5YX1H238"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"「単語の意味」を表すためには、人の手によって単語の意味を定義することが考えられます。","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"hWBEFJRTUv"}],"key":"y5f1r1JLZG"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"シソーラス(thesaurus)と呼ばれるタイプの辞書は、単語間の関係を異表記・類義語・上位下位といった関係性を用いて、単語間の関連を定義できます。","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ozeF7JexOh"}],"key":"PXLGp1cHce"},{"type":"math","value":"car = auto \\ automobile \\ machine \\ motorcar","position":{"start":{"line":5,"column":1},"end":{"line":7,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>c</mi><mi>a</mi><mi>r</mi><mo>=</mo><mi>a</mi><mi>u</mi><mi>t</mi><mi>o</mi><mtext> </mtext><mi>a</mi><mi>u</mi><mi>t</mi><mi>o</mi><mi>m</mi><mi>o</mi><mi>b</mi><mi>i</mi><mi>l</mi><mi>e</mi><mtext> </mtext><mi>m</mi><mi>a</mi><mi>c</mi><mi>h</mi><mi>i</mi><mi>n</mi><mi>e</mi><mtext> </mtext><mi>m</mi><mi>o</mi><mi>t</mi><mi>o</mi><mi>r</mi><mi>c</mi><mi>a</mi><mi>r</mi></mrow><annotation encoding=\"application/x-tex\">car = auto \\ automobile \\ machine \\ motorcar</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">c</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">o</span><span class=\"mspace\"> </span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">m</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">bi</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">e</span><span class=\"mspace\"> </span><span class=\"mord mathnormal\">ma</span><span class=\"mord mathnormal\">c</span><span class=\"mord mathnormal\">hin</span><span class=\"mord mathnormal\">e</span><span class=\"mspace\"> </span><span class=\"mord mathnormal\">m</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">orc</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span></span></span></span></span>","enumerator":"1","key":"phjPcfVdmI"},{"type":"image","url":"/build/thesaurus-e6b87b3b021bf776236a5a934e12c1bf.png","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"FBLQNjY5yi","urlSource":"./Figure/thesaurus.png"},{"type":"paragraph","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"この「単語ネットーワーク」を利用することで、コンピュータに単語間の関連性を伝えることができます。しかし、この手法には大きな欠点が存在します。","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"yWT34Poo8P"}],"key":"VRJ3oV8oeX"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":14,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"人の作業コストが高い","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"PTmTMRRtTy"}],"key":"T7IPLAAUvY"}],"key":"ZnCdjQa4co"},{"type":"listItem","spread":true,"position":{"start":{"line":15,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"時代の変化に対応するのが困難","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"lVLWQ6Z8WD"}],"key":"DHInUslzsX"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"言語は常に進化しており、新しい単語や意味が生まれては消えていくので、シソーラスを最新の状態に保つのは難しいです。","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"QRE9wulD4X"}],"key":"QLuEa3mkG9"}],"key":"aJJy0HL99M"}],"key":"IYKFxligfn"}],"key":"YhOrhcHfUB"},{"type":"listItem","spread":true,"position":{"start":{"line":17,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"単語の些細なかニュアンスを表現できない","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"xGaoucqyYq"}],"key":"ipAxE9jpFa"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":18,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"単語が持つ複数の意味を区別することは難しい","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"rZdaH4uu19"}],"key":"aTGZIGNBDq"}],"key":"SRoQOK1QPe"},{"type":"listItem","spread":true,"position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"単語間の関連性はシソーラスでは静的なものであり、動的な文脈や知識の流れを反映しきれないことがあります","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"dSRAxPzBz7"}],"key":"GaIlKyjxFT"}],"key":"f5H2IZr5TO"}],"key":"YCGWhUA7w7"}],"key":"ujYj3qvBPV"}],"key":"L98T1vkH8a"}],"key":"I2bDWQyDc9"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"カウントベースの手法","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ArGJnu1PhF"}],"identifier":"id","label":"カウントベースの手法","html_id":"id-1","implicit":true,"enumerator":"2","key":"nzOY3w8mF2"}],"key":"wViGtI09wa"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"コーパスには、自然言語に対する人の「知識」ー文章の書き方、単語の選び方、単語の意味ーがふんだんに含まれています。カウントベースの手法の目標は、そのような人の知識が詰まったコーパスから自動的に抽出することにあります。","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"fzfgRpzqMO"}],"key":"Pnfqz7T0kM"}],"key":"L3mcrqZxPV"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"コーパスの前処理","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Ymo17aVfLw"}],"identifier":"id","label":"コーパスの前処理","html_id":"id-2","implicit":true,"enumerator":"2.1","key":"Jry00U5DXV"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"コーパスに対して、テキストデータを単語に分割し、その分割した単語をID化にすることが必要されます。","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"RtfAWG5J1Q"}],"key":"RNq51ExhLk"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"単語のID化とは、テキストデータを機械学習モデルなどで処理する際に、単語を一意の整数値（ID）に変換するプロセスを指します。これは、テキストデータをベクトルや行列の形でモデルに入力するための前処理として行われます。","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"bkCFfqCqHh"}],"key":"wHvCXxiZVc"}],"key":"A66qfWllS5"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"例として、簡単なテキストを用意します。","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"IKX6JTd8iq"}],"key":"nvZmZS1Vnw"}],"key":"RY1ecZcJA1"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"text = 'You say goodbye and I say hello.'","key":"KJxYvQdaxc"},{"type":"outputs","id":"9nrrq-uZx68A8B9tgMFxE","children":[],"key":"DVN8eWmEfu"}],"key":"Fa2KyWJLL9"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# 小文字に変換\ntext = text.lower()\nprint(text)\n\n# ピリオドの前にスペースを挿入\ntext = text.replace('.', ' .')\nprint(text)\n\n# 単語ごとに分割\nwords = text.split(' ')\nprint(words)","key":"RCzXHpuLNH"},{"type":"outputs","id":"1C7yNRABGPw_HSQaXOWP_","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"you say goodbye and i say hello.\nyou say goodbye and i say hello .\n['you', 'say', 'goodbye', 'and', 'i', 'say', 'hello', '.']\n"},"children":[],"key":"TnFSBIrHV7"}],"key":"RafhA26HnQ"}],"key":"Fmn9Mi7AbQ"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"これで、元の文章を単語リストとして利用できるようになりました。これに基づいて、分割した単語と、単語ごとに通し番号を割り振ったIDを2つのディクショナリに格納します。","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"w1kDzLUnY0"}],"key":"gWfpAyrPw5"}],"key":"MYEUnfFf0s"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# ディクショナリを初期化\nword_to_id = {}\nid_to_word = {}\n\n# 未収録の単語をディクショナリに格納\nfor word in words:\n    if word not in word_to_id: # 未収録の単語のとき\n        # 次の単語のidを取得\n        new_id = len(word_to_id)\n        \n        # 単語IDを格納\n        word_to_id[word] = new_id\n        \n        # 単語を格納\n        id_to_word[new_id] = word","key":"XICN2TBjbJ"},{"type":"outputs","id":"Jm85nz_hqwLw4s-Qg_MEk","children":[],"key":"spmXxtE6Wi"}],"key":"Fhpj3GqVZ8"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# 単語IDを指定すると単語を返す\nprint(id_to_word)\nprint(id_to_word[5])\n\n# 単語を指定すると単語IDを返す\nprint(word_to_id)\nprint(word_to_id['hello'])","key":"RQUKMZifel"},{"type":"outputs","id":"LrpZe7wPn30DS1Lqx7gUJ","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"{0: 'you', 1: 'say', 2: 'goodbye', 3: 'and', 4: 'i', 5: 'hello', 6: '.'}\nhello\n{'you': 0, 'say': 1, 'goodbye': 2, 'and': 3, 'i': 4, 'hello': 5, '.': 6}\n5\n"},"children":[],"key":"SHPNa3Mz6S"}],"key":"bjTLhW8Nqu"}],"key":"rAILIB5fnq"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"最後に、単語リストから単語IDリストに変換します。","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"zWBBDb4dcm"}],"key":"BFUkBIoSra"}],"key":"OZqZpDMgtk"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import numpy as np\n# リストに変換\ncorpus = [word_to_id[word] for word in words]\n\n# NumPy配列に変換\ncorpus = np.array(corpus)\nprint(corpus)","key":"OSmi1zCQDj"},{"type":"outputs","id":"2GiTL1g9-9ahWTnlWxJPn","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"[0 1 2 3 4 1 5 6]\n"},"children":[],"key":"sMch82xVbJ"}],"key":"vmDgkYqPQY"}],"key":"wE2dFHwAXL"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"以上の処理を","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"y5kpZhE4fc"},{"type":"inlineCode","value":"preprocess()","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"HOwlSGEsia"},{"type":"text","value":"という関数として、まとめて実装することにします。","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"cRMWu6Jimz"}],"key":"FIYLGU7cm7"}],"key":"fHRJSvXyPI"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# 前処理関数の実装\ndef preprocess(text):\n    # 前処理\n    text = text.lower() # 小文字に変換\n    text = text.replace('.', ' .') # ピリオドの前にスペースを挿入\n    words = text.split(' ') # 単語ごとに分割\n    \n    # ディクショナリを初期化\n    word_to_id = {}\n    id_to_word = {}\n    \n    # 未収録の単語をディクショナリに格納\n    for word in words:\n        if word not in word_to_id: # 未収録の単語のとき\n            # 次の単語のidを取得\n            new_id = len(word_to_id)\n            \n            # 単語をキーとして単語IDを格納\n            word_to_id[word] = new_id\n            \n            # 単語IDをキーとして単語を格納\n            id_to_word[new_id] = word\n    \n    # 単語IDリストを作成\n    corpus = [word_to_id[w] for w in words]\n    \n    return corpus, word_to_id, id_to_word","key":"fu0Gj9VFXt"},{"type":"outputs","id":"EJ8qo0h1LRpdX4Sy7oKGc","children":[],"key":"IP5Om3r4FU"}],"key":"wqxKMLboNN"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# テキストを設定\ntext = 'You say goodbye and I say hello.'\n\n# 単語と単語IDに関する変数を取得\ncorpus, word_to_id, id_to_word = preprocess(text)\nprint(id_to_word)\nprint(word_to_id)\nprint(corpus)","key":"AGVp0Oq4bb"},{"type":"outputs","id":"HNg0kWPx95_Dd96gN_VGS","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"{0: 'you', 1: 'say', 2: 'goodbye', 3: 'and', 4: 'i', 5: 'hello', 6: '.'}\n{'you': 0, 'say': 1, 'goodbye': 2, 'and': 3, 'i': 4, 'hello': 5, '.': 6}\n[0, 1, 2, 3, 4, 1, 5, 6]\n"},"children":[],"key":"kDUHeGpFa9"}],"key":"npUTt537VL"}],"key":"bJgZZ21702"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"分布仮説","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"vyq1GCJ5UW"}],"identifier":"id","label":"分布仮説","html_id":"id-3","implicit":true,"enumerator":"2.2","key":"tRPGRY26Cr"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"分布仮説（Distributional Hypothesis）は、言語学や自然言語処理の分野で重要な考え方で、単語の意味は、周囲の単語(コンテキスト)によって形成されるというものです。","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"speGB8nWSq"}],"key":"VI7TBpwzaz"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":5,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"単語は、その単語が出現する文脈の集合によって意味が形成されるとされます。同じ文脈で出現する単語は、意味が似ていると考えられます。","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"UpcBLEd59g"}],"key":"rKalzAY9aj"}],"key":"XQhJ8zx9rW"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"単語Aと単語Bが多くの共通の文脈で使用される場合、これらの単語は意味的に関連があると見なされます。","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"Djtho2NI6E"}],"key":"u1tSIkwih7"}],"key":"iyQG6UZEoR"}],"key":"W6mhud9HOr"},{"type":"paragraph","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"この仮説は、単語の意味を捉えるためのモデルを作成する際に基本的な原則となっています。","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"bSVRYDDzUX"}],"key":"FKrhPHAvcY"},{"type":"image","url":"/build/DH-728020333e6c84573844db7813b14c20.png","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"zY3WylBVvu","urlSource":"./Figure/DH.png"}],"key":"M8wwTQj0JR"},{"type":"block","kind":"notebook-content","children":[{"type":"admonition","kind":"custom","class":"dropdown tohokupurple","icon":"question","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"周囲の単語による単語の意味を捉える？","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"MbzQLTEwWc"}],"key":"Q8auUgi6MY"},{"type":"div","style":{"display":"flex","justifyContent":"space-between","flexWrap":"wrap","gap":"8px"},"children":[{"type":"image","url":"/build/tezguino2-min-50c3a32da5d6386d078a7431f3550289.png","alt":"Fig1","key":"LaBsoSfyT0","urlSource":"./Figure/tezguino2-min.png"},{"type":"text","value":" ","key":"IaSdQEE0mF"},{"type":"image","url":"/build/tezguino3-min-0dc8e3f972c6fb53024382bde39009bb.png","alt":"Fig2","key":"nqRrsRIfU1","urlSource":"./Figure/tezguino3-min.png"},{"type":"text","value":" ","key":"mH3enW8NEd"},{"type":"image","url":"/build/tezguino6-min-4b8f4297491de2183f2753928db8f00f.png","alt":"Fig3","key":"JjLS8b88gc","urlSource":"./Figure/tezguino6-min.png"},{"type":"text","value":" ","key":"saUnFFppZI"},{"type":"image","url":"/build/tezguino9-min-79cc62296570a04126d84667a2ee5aaa.png","alt":"Fig4","key":"fjdWP4NUl6","urlSource":"./Figure/tezguino9-min.png"}],"key":"YbFLtD8dWC"}],"key":"XVY9ATinLR"}],"key":"opZpNyAVlO"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"共起行列","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"mqIKYTk1Sx"}],"identifier":"id","label":"共起行列","html_id":"id-4","implicit":true,"enumerator":"2.3","key":"utQkwYUTZb"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"分布仮説に基づいた単語ベクトル化の方法を考える際、一番素直な方法は、周囲の単語を\"カウント\"することです。つまり、ある単語に着目した場合、その周囲どのような単語がどれだけ現れるのかをカウントし、それを集計するのです。","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ORw3KgL4zm"}],"key":"TeKO9OIWSa"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"ここでは、\"","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"r4ov8pGkOl"},{"type":"emphasis","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"You say goodbye and I say hello.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"JFrUL4VqBY"}],"key":"wV5F1Mwg88"},{"type":"text","value":"\"という文章について、ウィンドウサイズを","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"mNp5QKj8Si"},{"type":"text","value":"1","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"PbXjnTIZJl"},{"type":"text","value":"とする場合、そのコンテキストに含まれる単語の頻度をカウントしてみます。","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"FgBGBUubam"}],"key":"ABx9d2GPRF"}],"key":"cQkgrtiJoY"},{"type":"block","kind":"notebook-content","children":[{"type":"container","kind":"figure","children":[{"type":"image","url":"/build/co-occur-89467a404bde28e7fc822427c6c6acf3.png","alt":"各単語について、そのコンテキストに含まれす単語の頻度","align":"center","data":{"altTextIsAutoGenerated":true},"key":"b7RSQUatBV","urlSource":"./Figure/co-occur.png"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"各単語について、そのコンテキストに含まれす単語の頻度","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"YQwiSIanAY"}],"key":"lUUFMSW712"}],"key":"LsVvi9HKpN"}],"enumerator":"3","key":"JSGf4rmiOT"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":9,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"「You」の周辺単語は「say」のみであり、「say」にのみコンテキストの目印として共起した回数の","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"tENEQA2MgI"},{"type":"text","value":"1","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"CS5VBXYOla"},{"type":"text","value":"をカウントします","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"TzjIg2GjxO"}],"key":"bpS2dkWbU0"}],"key":"QJv3oPUmGT"},{"type":"listItem","spread":true,"position":{"start":{"line":10,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"「say」については文字列中に2回現れていることに注意すると、","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"HcOCY2jq7d"},{"type":"inlineMath","value":"[1, 0, 1, 0, 1, 1, 0]","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mn>1</mn><mo separator=\"true\">,</mo><mn>0</mn><mo separator=\"true\">,</mo><mn>1</mn><mo separator=\"true\">,</mo><mn>0</mn><mo separator=\"true\">,</mo><mn>1</mn><mo separator=\"true\">,</mo><mn>1</mn><mo separator=\"true\">,</mo><mn>0</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[1, 0, 1, 0, 1, 1, 0]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">0</span><span class=\"mclose\">]</span></span></span></span>","key":"zbLrjebVDf"},{"type":"text","value":"とベクトル表記できます","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"ElLwPmw50t"}],"key":"hSSb1tFrI2"}],"key":"gk4TgpK3Pg"}],"key":"oAET3FgT1v"},{"type":"paragraph","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"全ての単語に対して、共起する単語をまとめたものを共起行列と呼ばれます。","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"MDCoqnvK3b"}],"key":"bCXl3LKt70"}],"key":"Co0RrHW0UP"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# ウィンドウサイズを指定\nwndow_size = 1\n\n# 単語の種類数を取得\nvocab_size = len(word_to_id)\nprint(f\"単語の種類数: {vocab_size}\")\n\n# 総単語数を取得\ncorpus_size = len(corpus)\nprint(f\"総単語数: {corpus_size}\")","key":"OShX63muqB"},{"type":"outputs","id":"V9ihHAwRXkBL3NmIKv3mC","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"単語の種類数: 7\n総単語数: 8\n"},"children":[],"key":"ovSXzGQSC0"}],"key":"s3ULVVN7mY"}],"key":"bvQ0jrBltS"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# 共起行列を初期化\nco_matrix = np.zeros((vocab_size, vocab_size), dtype=np.int32)\nprint(co_matrix)\nprint(co_matrix.shape)","key":"BitZ2TMz9U"},{"type":"outputs","id":"fg_CjJXezeCBxRrPEWekk","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"[[0 0 0 0 0 0 0]\n [0 0 0 0 0 0 0]\n [0 0 0 0 0 0 0]\n [0 0 0 0 0 0 0]\n [0 0 0 0 0 0 0]\n [0 0 0 0 0 0 0]\n [0 0 0 0 0 0 0]]\n(7, 7)\n"},"children":[],"key":"EAYTFnzyrt"}],"key":"RpNkbY2Yrw"}],"key":"kiOKxPYAeB"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"コーパスの7語目の単語「hello」に注目してみます。","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"w3k3YpI2dq"}],"key":"cLMj6VXTqC"}],"key":"ylxWSmTIgn"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# 単語インデックスを指定\nidx = 6\n\n# 指定した単語のIDを取得\nword_id = corpus[idx]\nprint(word_id)\nprint(id_to_word[word_id])","key":"WAKgvYPtdB"},{"type":"outputs","id":"vGxzSB06HiQTCU0TA92hR","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"5\nhello\n"},"children":[],"key":"Vy6g4UGc0p"}],"key":"vBNAUGX10p"}],"key":"cAVyAXWSFP"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# 左隣のインデックス\nleft_idx = idx - 1\nprint(left_idx)\n\n# 右隣のインデックス\nright_idx = idx + 1\nprint(right_idx)","key":"oOqibkhrFQ"},{"type":"outputs","id":"jbsPzmbK4kSQ3zRhp0E9f","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"5\n7\n"},"children":[],"key":"CPl77hw5on"}],"key":"bA7Ogbn6LC"}],"key":"segTO00qdS"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# 左隣の単語IDを取得\nleft_word_id = corpus[left_idx]\nprint(left_word_id)\nprint(id_to_word[left_word_id])\n\n# 共起行列に記録(加算)\nco_matrix[word_id, left_word_id] += 1\nprint(co_matrix)","key":"IVgkcI3AkH"},{"type":"outputs","id":"aQb4rKguhbhXcp7XJHNu8","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"1\nsay\n[[0 0 0 0 0 0 0]\n [0 0 0 0 0 0 0]\n [0 0 0 0 0 0 0]\n [0 0 0 0 0 0 0]\n [0 0 0 0 0 0 0]\n [0 1 0 0 0 0 0]\n [0 0 0 0 0 0 0]]\n"},"children":[],"key":"puLWu9W0Jf"}],"key":"d3GkwBpffG"}],"key":"lHLAg0UFJ6"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# 右隣の単語IDを取得\nright_word_id = corpus[right_idx]\nprint(right_word_id)\nprint(id_to_word[right_word_id])\n\n# 共起行列に記録(加算)\nco_matrix[word_id, right_word_id] += 1\nprint(co_matrix)\n\n# 対象の単語ベクトル\nprint(co_matrix[word_id])","key":"XbzlAlsj11"},{"type":"outputs","id":"6914O1B38AUNbueu_ofBZ","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"6\n.\n[[0 0 0 0 0 0 0]\n [0 0 0 0 0 0 0]\n [0 0 0 0 0 0 0]\n [0 0 0 0 0 0 0]\n [0 0 0 0 0 0 0]\n [0 1 0 0 0 0 1]\n [0 0 0 0 0 0 0]]\n[0 1 0 0 0 0 1]\n"},"children":[],"key":"zNDTN5yLi8"}],"key":"QWZhpiaqsq"}],"key":"FHj0ldAs2X"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"処理を共起行列を作成する関数として実装します。","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"F0UNQIUiSN"}],"key":"JfKza30xXI"}],"key":"ivEUsJrd57"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# 共起行列作成関数の実装\ndef create_co_matrix(corpus, vocab_size, window_size=1):\n    \n    # 総単語数を取得\n    corpus_size = len(corpus)\n    \n    # 共起行列を初期化\n    co_matrix = np.zeros((vocab_size, vocab_size), dtype=np.int32)\n    \n    # 1語ずつ処理\n    for idx, word_id in enumerate(corpus):\n        \n        # ウィンドウサイズまでの要素を順番に処理\n        for i in range(1, window_size + 1):\n            # 範囲内のインデックスを計算\n            left_idx = idx - i\n            right_idx = idx + i\n            \n            # 左側の単語の処理\n            if left_idx >= 0: # 対象の単語が最初の単語でないとき\n                # 単語IDを取得\n                left_word_id = corpus[left_idx]\n                \n                # 共起行列にカウント\n                co_matrix[word_id, left_word_id] += 1\n            \n            # 右側の単語の処理\n            if right_idx < corpus_size: # 対象の単語が最後の単語でないとき\n                # 単語IDを取得\n                right_word_id = corpus[right_idx]\n                \n                # 共起行列にカウント\n                co_matrix[word_id, right_word_id] += 1\n    \n    return co_matrix","key":"wd7JT3Sx47"},{"type":"outputs","id":"F5HktvskZ8ISB5GuNBD8N","children":[],"key":"RhZhbU8pFp"}],"key":"RR2OGbL1mq"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"ベクトル間の類似度","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ynJleisceZ"}],"identifier":"id","label":"ベクトル間の類似度","html_id":"id-5","implicit":true,"enumerator":"2.4","key":"R2I2OYCVFd"},{"type":"heading","depth":4,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"コサイン類似度","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"u0cDp2CuJQ"}],"identifier":"id","label":"コサイン類似度","html_id":"id-6","implicit":true,"enumerator":"2.4.1","key":"YgQ5sQfCuQ"}],"key":"bnbH3jGnzy"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"共起行列によって単語をベクトルで表すことができました。単語の意味を「計算」する手法として、ベクトル間の類似度の計測する方法について見ていきます。","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"mqcHeh116t"}],"key":"PI89D49Ds6"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"様々な方法がありますが、単語のベクトル表現の類似度に関して、コサイン類似度がよく用いられます。","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"bvtBMW5ZLc"}],"key":"bvTXXQ613a"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"コサイン類似度とは、2つのベクトルを","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"O0plMCzmM2"},{"type":"inlineMath","value":"\\mathbf{x} = (x_1, x_2, \\cdots, x_n), \\mathbf{y} = (y_1, y_2, \\cdots, y_n)","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">x</mi><mo>=</mo><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><msub><mi>x</mi><mn>2</mn></msub><mo separator=\"true\">,</mo><mo>⋯</mo><mtext> </mtext><mo separator=\"true\">,</mo><msub><mi>x</mi><mi>n</mi></msub><mo stretchy=\"false\">)</mo><mo separator=\"true\">,</mo><mi mathvariant=\"bold\">y</mi><mo>=</mo><mo stretchy=\"false\">(</mo><msub><mi>y</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><msub><mi>y</mi><mn>2</mn></msub><mo separator=\"true\">,</mo><mo>⋯</mo><mtext> </mtext><mo separator=\"true\">,</mo><msub><mi>y</mi><mi>n</mi></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\mathbf{x} = (x_1, x_2, \\cdots, x_n), \\mathbf{y} = (y_1, y_2, \\cdots, y_n)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4444em;\"></span><span class=\"mord mathbf\">x</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\">⋯</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">y</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\">⋯</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"I01GBUu3q4"},{"type":"text","value":"として、次の式で定義されます。","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"Nndxeeh7Lc"}],"key":"UZhPe2bYRk"},{"type":"math","value":"\\begin{align}\n\\mathrm{similarity}(\\mathbf{x}, \\mathbf{y})\n   &= \\frac{\n          \\mathbf{x} \\cdot \\mathbf{y}\n      }{\n          \\|\\mathbf{x}\\| \\|\\mathbf{y}\\|\n      }\n\\\\\n   &= \\frac{\n          x_1 y_1 + x_2 y_2 + \\cdots + x_n y_n\n      }{\n          \\sqrt{x_1^2 + x_2^2 + \\cdots + x_n^2}\n          \\sqrt{y_1^2 + y_2^2 + \\cdots + y_n^2}\n      }\n\\\\\n   &= \\frac{\n          \\sum_{n} x_n y_n\n      }{\n          \\sqrt{\\sum_{n} x_n^2}\n          \\sqrt{\\sum_{n} y_n^2}\n      }\n\\end{align}","position":{"start":{"line":7,"column":1},"end":{"line":30,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mtable rowspacing=\"0.25em\" columnalign=\"right left\" columnspacing=\"0em\"><mtr><mtd class =\"mtr-glue\"></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow><mi mathvariant=\"normal\">s</mi><mi mathvariant=\"normal\">i</mi><mi mathvariant=\"normal\">m</mi><mi mathvariant=\"normal\">i</mi><mi mathvariant=\"normal\">l</mi><mi mathvariant=\"normal\">a</mi><mi mathvariant=\"normal\">r</mi><mi mathvariant=\"normal\">i</mi><mi mathvariant=\"normal\">t</mi><mi mathvariant=\"normal\">y</mi></mrow><mo stretchy=\"false\">(</mo><mi mathvariant=\"bold\">x</mi><mo separator=\"true\">,</mo><mi mathvariant=\"bold\">y</mi><mo stretchy=\"false\">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>=</mo><mfrac><mrow><mi mathvariant=\"bold\">x</mi><mo>⋅</mo><mi mathvariant=\"bold\">y</mi></mrow><mrow><mi mathvariant=\"normal\">∥</mi><mi mathvariant=\"bold\">x</mi><mi mathvariant=\"normal\">∥</mi><mi mathvariant=\"normal\">∥</mi><mi mathvariant=\"bold\">y</mi><mi mathvariant=\"normal\">∥</mi></mrow></mfrac></mrow></mstyle></mtd><mtd class =\"mtr-glue\"></mtd><mtd class =\"mml-eqn-num\"></mtd></mtr><mtr><mtd class =\"mtr-glue\"></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>=</mo><mfrac><mrow><msub><mi>x</mi><mn>1</mn></msub><msub><mi>y</mi><mn>1</mn></msub><mo>+</mo><msub><mi>x</mi><mn>2</mn></msub><msub><mi>y</mi><mn>2</mn></msub><mo>+</mo><mo>⋯</mo><mo>+</mo><msub><mi>x</mi><mi>n</mi></msub><msub><mi>y</mi><mi>n</mi></msub></mrow><mrow><msqrt><mrow><msubsup><mi>x</mi><mn>1</mn><mn>2</mn></msubsup><mo>+</mo><msubsup><mi>x</mi><mn>2</mn><mn>2</mn></msubsup><mo>+</mo><mo>⋯</mo><mo>+</mo><msubsup><mi>x</mi><mi>n</mi><mn>2</mn></msubsup></mrow></msqrt><msqrt><mrow><msubsup><mi>y</mi><mn>1</mn><mn>2</mn></msubsup><mo>+</mo><msubsup><mi>y</mi><mn>2</mn><mn>2</mn></msubsup><mo>+</mo><mo>⋯</mo><mo>+</mo><msubsup><mi>y</mi><mi>n</mi><mn>2</mn></msubsup></mrow></msqrt></mrow></mfrac></mrow></mstyle></mtd><mtd class =\"mtr-glue\"></mtd><mtd class =\"mml-eqn-num\"></mtd></mtr><mtr><mtd class =\"mtr-glue\"></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>=</mo><mfrac><mrow><munder><mo>∑</mo><mi>n</mi></munder><msub><mi>x</mi><mi>n</mi></msub><msub><mi>y</mi><mi>n</mi></msub></mrow><mrow><msqrt><mrow><munder><mo>∑</mo><mi>n</mi></munder><msubsup><mi>x</mi><mi>n</mi><mn>2</mn></msubsup></mrow></msqrt><msqrt><mrow><munder><mo>∑</mo><mi>n</mi></munder><msubsup><mi>y</mi><mi>n</mi><mn>2</mn></msubsup></mrow></msqrt></mrow></mfrac></mrow></mstyle></mtd><mtd class =\"mtr-glue\"></mtd><mtd class =\"mml-eqn-num\"></mtd></mtr></mtable><annotation encoding=\"application/x-tex\">\\begin{align}\n\\mathrm{similarity}(\\mathbf{x}, \\mathbf{y})\n   &amp;= \\frac{\n          \\mathbf{x} \\cdot \\mathbf{y}\n      }{\n          \\|\\mathbf{x}\\| \\|\\mathbf{y}\\|\n      }\n\\\\\n   &amp;= \\frac{\n          x_1 y_1 + x_2 y_2 + \\cdots + x_n y_n\n      }{\n          \\sqrt{x_1^2 + x_2^2 + \\cdots + x_n^2}\n          \\sqrt{y_1^2 + y_2^2 + \\cdots + y_n^2}\n      }\n\\\\\n   &amp;= \\frac{\n          \\sum_{n} x_n y_n\n      }{\n          \\sqrt{\\sum_{n} x_n^2}\n          \\sqrt{\\sum_{n} y_n^2}\n      }\n\\end{align}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:7.9175em;vertical-align:-3.7087em;\"></span><span class=\"mtable\"><span class=\"col-align-r\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:4.2087em;\"><span style=\"top:-6.527em;\"><span class=\"pstrut\" style=\"height:3.4397em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathrm\" style=\"margin-right:0.01389em;\">similarity</span></span><span class=\"mopen\">(</span><span class=\"mord mathbf\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">y</span><span class=\"mclose\">)</span></span></span><span style=\"top:-4.0307em;\"><span class=\"pstrut\" style=\"height:3.4397em;\"></span><span class=\"mord\"></span></span><span style=\"top:-1.161em;\"><span class=\"pstrut\" style=\"height:3.4397em;\"></span><span class=\"mord\"></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.7087em;\"><span></span></span></span></span></span><span class=\"col-align-l\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:4.2087em;\"><span style=\"top:-6.527em;\"><span class=\"pstrut\" style=\"height:3.4397em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.1214em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">∥</span><span class=\"mord mathbf\">x</span><span class=\"mord\">∥∥</span><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">y</span><span class=\"mord\">∥</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">y</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.936em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span><span style=\"top:-4.0307em;\"><span class=\"pstrut\" style=\"height:3.4397em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.2603em;\"><span style=\"top:-2.1602em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord sqrt\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9498em;\"><span class=\"svg-align\" style=\"top:-3.2em;\"><span class=\"pstrut\" style=\"height:3.2em;\"></span><span class=\"mord\" style=\"padding-left:1em;\"><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7959em;\"><span style=\"top:-2.4337em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span><span style=\"top:-3.0448em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2663em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7959em;\"><span style=\"top:-2.4337em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span><span style=\"top:-3.0448em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2663em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"minner\">⋯</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7401em;\"><span style=\"top:-2.453em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span><span style=\"top:-2.989em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.247em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-2.9098em;\"><span class=\"pstrut\" style=\"height:3.2em;\"></span><span class=\"hide-tail\" style=\"min-width:1.02em;height:1.28em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='400em' height='1.28em' viewBox='0 0 400000 1296' preserveAspectRatio='xMinYMin slice'><path d='M263,681c0.7,0,18,39.7,52,119\nc34,79.3,68.167,158.7,102.5,238c34.3,79.3,51.8,119.3,52.5,120\nc340,-704.7,510.7,-1060.3,512,-1067\nl0 -0\nc4.7,-7.3,11,-11,19,-11\nH40000v40H1012.3\ns-271.3,567,-271.3,567c-38.7,80.7,-84,175,-136,283c-52,108,-89.167,185.3,-111.5,232\nc-22.3,46.7,-33.8,70.3,-34.5,71c-4.7,4.7,-12.3,7,-23,7s-12,-1,-12,-1\ns-109,-253,-109,-253c-72.7,-168,-109.3,-252,-110,-252c-10.7,8,-22,16.7,-34,26\nc-22,17.3,-33.3,26,-34,26s-26,-26,-26,-26s76,-59,76,-59s76,-60,76,-60z\nM1001 80h400000v40h-400000z'/></svg></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2902em;\"><span></span></span></span></span></span><span class=\"mord sqrt\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9498em;\"><span class=\"svg-align\" style=\"top:-3.2em;\"><span class=\"pstrut\" style=\"height:3.2em;\"></span><span class=\"mord\" style=\"padding-left:1em;\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7959em;\"><span style=\"top:-2.4337em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span><span style=\"top:-3.0448em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2663em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7959em;\"><span style=\"top:-2.4337em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span><span style=\"top:-3.0448em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2663em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"minner\">⋯</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7401em;\"><span style=\"top:-2.453em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span><span style=\"top:-2.989em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.247em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-2.9098em;\"><span class=\"pstrut\" style=\"height:3.2em;\"></span><span class=\"hide-tail\" style=\"min-width:1.02em;height:1.28em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='400em' height='1.28em' viewBox='0 0 400000 1296' preserveAspectRatio='xMinYMin slice'><path d='M263,681c0.7,0,18,39.7,52,119\nc34,79.3,68.167,158.7,102.5,238c34.3,79.3,51.8,119.3,52.5,120\nc340,-704.7,510.7,-1060.3,512,-1067\nl0 -0\nc4.7,-7.3,11,-11,19,-11\nH40000v40H1012.3\ns-271.3,567,-271.3,567c-38.7,80.7,-84,175,-136,283c-52,108,-89.167,185.3,-111.5,232\nc-22.3,46.7,-33.8,70.3,-34.5,71c-4.7,4.7,-12.3,7,-23,7s-12,-1,-12,-1\ns-109,-253,-109,-253c-72.7,-168,-109.3,-252,-110,-252c-10.7,8,-22,16.7,-34,26\nc-22,17.3,-33.3,26,-34,26s-26,-26,-26,-26s76,-59,76,-59s76,-60,76,-60z\nM1001 80h400000v40h-400000z'/></svg></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2902em;\"><span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"minner\">⋯</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.13em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span><span style=\"top:-1.161em;\"><span class=\"pstrut\" style=\"height:3.4397em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.4397em;\"><span style=\"top:-2.1999em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord sqrt\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9101em;\"><span class=\"svg-align\" style=\"top:-3.2em;\"><span class=\"pstrut\" style=\"height:3.2em;\"></span><span class=\"mord\" style=\"padding-left:1em;\"><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">∑</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.0017em;\"><span style=\"top:-2.4003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2997em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7401em;\"><span style=\"top:-2.453em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span><span style=\"top:-2.989em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.247em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-2.8701em;\"><span class=\"pstrut\" style=\"height:3.2em;\"></span><span class=\"hide-tail\" style=\"min-width:1.02em;height:1.28em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='400em' height='1.28em' viewBox='0 0 400000 1296' preserveAspectRatio='xMinYMin slice'><path d='M263,681c0.7,0,18,39.7,52,119\nc34,79.3,68.167,158.7,102.5,238c34.3,79.3,51.8,119.3,52.5,120\nc340,-704.7,510.7,-1060.3,512,-1067\nl0 -0\nc4.7,-7.3,11,-11,19,-11\nH40000v40H1012.3\ns-271.3,567,-271.3,567c-38.7,80.7,-84,175,-136,283c-52,108,-89.167,185.3,-111.5,232\nc-22.3,46.7,-33.8,70.3,-34.5,71c-4.7,4.7,-12.3,7,-23,7s-12,-1,-12,-1\ns-109,-253,-109,-253c-72.7,-168,-109.3,-252,-110,-252c-10.7,8,-22,16.7,-34,26\nc-22,17.3,-33.3,26,-34,26s-26,-26,-26,-26s76,-59,76,-59s76,-60,76,-60z\nM1001 80h400000v40h-400000z'/></svg></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3299em;\"><span></span></span></span></span></span><span class=\"mord sqrt\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9101em;\"><span class=\"svg-align\" style=\"top:-3.2em;\"><span class=\"pstrut\" style=\"height:3.2em;\"></span><span class=\"mord\" style=\"padding-left:1em;\"><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">∑</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.0017em;\"><span style=\"top:-2.4003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2997em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7401em;\"><span style=\"top:-2.453em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span><span style=\"top:-2.989em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.247em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-2.8701em;\"><span class=\"pstrut\" style=\"height:3.2em;\"></span><span class=\"hide-tail\" style=\"min-width:1.02em;height:1.28em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='400em' height='1.28em' viewBox='0 0 400000 1296' preserveAspectRatio='xMinYMin slice'><path d='M263,681c0.7,0,18,39.7,52,119\nc34,79.3,68.167,158.7,102.5,238c34.3,79.3,51.8,119.3,52.5,120\nc340,-704.7,510.7,-1060.3,512,-1067\nl0 -0\nc4.7,-7.3,11,-11,19,-11\nH40000v40H1012.3\ns-271.3,567,-271.3,567c-38.7,80.7,-84,175,-136,283c-52,108,-89.167,185.3,-111.5,232\nc-22.3,46.7,-33.8,70.3,-34.5,71c-4.7,4.7,-12.3,7,-23,7s-12,-1,-12,-1\ns-109,-253,-109,-253c-72.7,-168,-109.3,-252,-110,-252c-10.7,8,-22,16.7,-34,26\nc-22,17.3,-33.3,26,-34,26s-26,-26,-26,-26s76,-59,76,-59s76,-60,76,-60z\nM1001 80h400000v40h-400000z'/></svg></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3299em;\"><span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.6897em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">∑</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.0017em;\"><span style=\"top:-2.4003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2997em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.13em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.7087em;\"><span></span></span></span></span></span></span></span><span class=\"tag\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:4.2087em;\"><span style=\"top:-6.527em;\"><span class=\"pstrut\" style=\"height:3.4397em;\"></span><span class=\"eqn-num\"></span></span><span style=\"top:-4.0307em;\"><span class=\"pstrut\" style=\"height:3.4397em;\"></span><span class=\"eqn-num\"></span></span><span style=\"top:-1.161em;\"><span class=\"pstrut\" style=\"height:3.4397em;\"></span><span class=\"eqn-num\"></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.7087em;\"><span></span></span></span></span></span></span></span></span>","enumerator":"2","key":"WVsmUKu059"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":32,"column":1},"end":{"line":33,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"分子はベクトルの内積","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"key":"qNRJF4Lnil"}],"key":"d7B6NgBT7c"}],"key":"bSoMGK52N6"},{"type":"listItem","spread":true,"position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"分母は各ベクトルの「ノルム」(ベクトルの大きさ)があります。","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"o1oyFjCTdI"}],"key":"NNfCUKdyA8"}],"key":"PslQJKGeUo"}],"key":"WRjgHEwQVS"}],"key":"lE304NTl9H"},{"type":"block","kind":"notebook-content","children":[{"type":"aside","children":[{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"epsは、","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"FYaAUWxaqG"},{"type":"text","value":"0","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"HtBgjLgGES"},{"type":"text","value":"除算とならないための微小な値です。通常、このような小さな値は浮動小数点の「丸の誤差」により、他の値に\"吸収\"されますので、最終の計算結果に影響を与えません。","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"TQI38jsNA6"}],"key":"V6oqWz0HjT"}],"key":"R1V4PYqT84"}],"key":"r7pHCVyeQJ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# コサイン類似度の実装\ndef cos_similarity(x, y, eps=1e-8):\n    # コサイン類似度を計算:式(2.1)\n    nx = x / (np.sqrt(np.sum(x**2)) + eps)\n    ny = y / (np.sqrt(np.sum(y**2)) + eps)\n    return np.dot(nx, ny)","key":"F3LYh9po10"},{"type":"outputs","id":"zzu3JqNjU_pipqM2wUJyj","children":[],"key":"LC6v9xEkW7"}],"key":"WRvSnbSJbU"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"実装した関数を使って、ベクトルの値とコサイン類似度の値との関係を見ましょう。","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"DsEe98PtLb"}],"key":"pPeHIfPOFQ"}],"key":"z52AnNSNke"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"a_vec = np.array([5.0, 5.0])\nb_vec = np.array([3.0, 9.0])","key":"HYDEEU7w5n"},{"type":"outputs","id":"yjxG3OXL6iPPPglTJDJqF","children":[],"key":"ZB08TdOqeS"}],"key":"cn5uNw2WXN"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import matplotlib.pyplot as plt\n#import seaborn as sns\n\n# Set Seaborn theme\n#sns.set_context(\"paper\") # or \"talk\"\n#sns.set_style(\"whitegrid\")\n\n# コサイン類似度を計算\nsim_val = cos_similarity(a_vec, b_vec)\n\n# 作図\nplt.quiver(0, 0, a_vec[0], a_vec[1], angles='xy', scale_units='xy', scale=1, color='b', label='vector a') # 有効グラフ\nplt.quiver(0, 0, b_vec[0], b_vec[1], angles='xy', scale_units='xy', scale=1, color='r', label='vector b') # 有効グラフ\nplt.xlim(min(0, a_vec[0], b_vec[0]) - 1, max(0, a_vec[0], b_vec[0]) + 1)\nplt.ylim(min(0, a_vec[1], b_vec[1]) - 1, max(0, a_vec[1], b_vec[1]) + 1)\nplt.legend() \nplt.grid() \nplt.title('Similarity:' + str(np.round(sim_val, 3)), fontsize=20)\nplt.show()","key":"I7CfrYxqGD"},{"type":"outputs","id":"E_T8YNtkaK4fcJ4YeifI2","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"3fd4b7f809746c355044a458e2c8b05e","path":"/build/3fd4b7f809746c355044a458e2c8b05e.png"},"text/plain":{"content":"<Figure size 640x480 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"aAFiS180o8"}],"key":"vzO7v2z59Q"}],"key":"mJ9okMCQMl"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# Function to create a subplot for vectors with a given cosine similarity\ndef plot_vector_similarity(ax, similarity, vector_a):\n    # Generate vector b based on desired cosine similarity and vector a\n    angle = np.arccos(similarity)\n    vector_b = np.array([np.cos(angle), np.sin(angle)]) * np.linalg.norm(vector_a)\n    \n    # Plotting the vectors\n    ax.quiver(0, 0, vector_a[0], vector_a[1], angles='xy', scale_units='xy', scale=1, color='b', label='vector a')\n    ax.quiver(0, 0, vector_b[0], vector_b[1], angles='xy', scale_units='xy', scale=1, color='r', label='vector b')\n    \n    # Setting the limits of the plot\n    lim = np.max(np.abs(np.array([vector_a, vector_b]))) + 0.1\n    ax.set_xlim(-lim, lim)\n    ax.set_ylim(-lim, lim)\n    \n    # Adding grid, legend, and title to the subplot\n    ax.legend()\n    ax.grid(True)\n    ax.set_title('Similarity: ' + str(similarity))\n\n# Initial vector a\na_vec = np.array([1, 0])\n\n# Similarity values to plot\nsimilarities = [1, 0.8, 0.5, 0, -0.5, -1]\n\n# Create subplots\nfig, axes = plt.subplots(2, 3, figsize=(12, 8))\n\n# Flatten axes array for easy iteration\naxes_flat = axes.flatten()\n\n# Plot each similarity in a subplot\nfor ax, sim in zip(axes_flat, similarities):\n    plot_vector_similarity(ax, sim, a_vec)\n\nplt.tight_layout()\nplt.show()","visibility":"show","key":"o578dUAYij"},{"type":"outputs","id":"6vWTYM4RLOMC_fNEamGcW","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"e8b1ecd6bac345e4b1f0b1683e947573","path":"/build/e8b1ecd6bac345e4b1f0b1683e947573.png"},"text/plain":{"content":"<Figure size 1200x800 with 6 Axes>","content_type":"text/plain"}}},"children":[],"key":"DRu9HokiBe"}],"visibility":"show","key":"D0YtBMQF56"}],"visibility":"hide","key":"aC0OJp9Suz"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"単語間の類似度","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ZqazVOEW3W"}],"identifier":"id","label":"単語間の類似度","html_id":"id-7","implicit":true,"enumerator":"2.4.2","key":"TebYHuEXaU"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"前項で作成した各単語ベクトルを用いて、2つの単語の類似度を測りましょう。","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"zij3PQf79O"}],"key":"XCKFpUMQJV"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"比較したい2つの単語を指定して、単語ベクトルからコサイン類似度を計算します。","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"lDRhrKfYED"}],"key":"XwuSPup1xL"}],"key":"AGZpTvOyUN"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# テキストを設定\ntext = 'You say goodbye and I say hello.'\n\n# 単語と単語IDに関する変数を取得\ncorpus, word_to_id, id_to_word = preprocess(text)\n\n# 単語の種類数を取得\nvocab_size = len(word_to_id)\n\n# 共起行列を作成\nword_matrix = create_co_matrix(corpus, vocab_size, window_size=1)\n\n# 単語を指定して単語ベクトルを取得\nc0 = word_matrix[word_to_id['you']]\nc1 = word_matrix[word_to_id['i']]\nprint(c0)\nprint(c1)\n\n# コサイン類似度を計算\nsim_val = cos_similarity(c0, c1)\nprint(sim_val)","key":"JwfCVkAW5Z"},{"type":"outputs","id":"cgtICEda68B58IZ_Ox0x-","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"[0 1 0 0 0 0 0]\n[0 1 0 1 0 0 0]\n0.7071067691154799\n"},"children":[],"key":"QnC8lN3tTw"}],"key":"z10eDRlThe"}],"key":"ZfYHN6Zqw6"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"類似度のランキングを表示","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"kVf7XYoQxq"}],"identifier":"id","label":"類似度のランキングを表示","html_id":"id-8","implicit":true,"enumerator":"2.4.3","key":"Mm2kcKSPtf"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"単語の「意味」を分析する際には、ある単語に対して類似した単語を探すことがよく挙げられます。ここでは、指定した単語との類似度が高い単語を調べる関数を実装します。","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"XqvHelNF4T"}],"key":"ovq6AKhGPI"}],"key":"tSkv8CACOb"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# 対象とする単語を指定\nquery = 'you'\n\n# 指定した単語のIDを取得\nquery_id = word_to_id[query]\nprint(f\"指定した単語のID:{query_id}\")\n\n# 指定した単語のベクトルを取得\nquery_vec = word_matrix[query_id]\nprint(f\"指定した単語のベクトル: {query_vec}\")\n\n# コサイン類似度の記録リストを初期化\nvocab_size = len(id_to_word)\nsimilarity = np.zeros(vocab_size)\n\n# 各単語コサイン類似度を計算\nfor i in range(vocab_size):\n    similarity[i] = cos_similarity(word_matrix[i], query_vec)\n\n# 値を表示\nprint(\"類似度の結果：\")\nfor i,j in zip(list(word_to_id.keys()),np.round(similarity, 5)):\n    print(f\"{i}:{j}\")","key":"j5sDOl9D4I"},{"type":"outputs","id":"Iu3vGi0NWRLNCe2P5vZb0","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"指定した単語のID:0\n指定した単語のベクトル: [0 1 0 0 0 0 0]\n類似度の結果：\nyou:1.0\nsay:0.0\ngoodbye:0.70711\nand:0.0\ni:0.70711\nhello:0.70711\n.:0.0\n"},"children":[],"key":"em2y4N1HlL"}],"key":"faUAO2NFXK"}],"key":"J9Rq52KgYB"},{"type":"block","kind":"notebook-content","children":[{"type":"admonition","kind":"custom","class":"dropdown tohokupurple","icon":"question","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"argsortメソッド","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"NXp21Ufb6a"}],"key":"eHAUajbW9m"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"inlineCode","value":".argsort()","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"gRFcjcfOsA"},{"type":"text","value":"メソッドは、配列の要素の値が小さい順にインデックスを返します。ここで知りたいのは上位のインデックスのため、similarityに-1を掛けて符号を反転させることで、大小関係を逆転させます。","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"lnJSvUQaH8"}],"key":"HHueGGNkpU"}],"key":"FIsDpMn8t7"}],"key":"aPRNd7lRlr"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# 配列を作成\narr = np.array([0, 20, 10, 40, 30])\nprint(arr)\n\n# 低い順のインデックス\nprint(arr.argsort())\n\n# 大小関係を逆転\nprint(-1 * arr)\n\n# 高い順のインデックス\nprint((-1 * arr).argsort())","visibility":"show","key":"jfi48gs6SG"},{"type":"outputs","id":"vCzpwdZXzNlCTMKR9lqFs","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"[ 0 20 10 40 30]\n[0 2 1 4 3]\n[  0 -20 -10 -40 -30]\n[3 4 1 2 0]\n"},"children":[],"key":"ox0O9ARM4l"}],"visibility":"show","key":"NrVUakXVAl"}],"visibility":"hide","key":"NDoobbaYGA"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# 表示する順位を指定\ntop = 5\n\n# 類似度上位の単語と値を表示\ncount = 0 # 表示回数を初期化\nfor i in (-1 * similarity).argsort():\n    \n    # 指定した単語のときは次の単語に移る\n    if id_to_word[i] == query:\n        continue\n    \n    # 単語と値を表示\n    print(' %s: %s' % (id_to_word[i], similarity[i]))\n    \n    # 指定した回数に達したら処理を終了\n    count += 1 # 表示回数を加算\n    if count >= top:\n        break","key":"g7jGhHzxxf"},{"type":"outputs","id":"zPDSBULJnh2sb7soy4d4p","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":" goodbye: 0.7071067691154799\n i: 0.7071067691154799\n hello: 0.7071067691154799\n say: 0.0\n and: 0.0\n"},"children":[],"key":"GA1qkCdTRf"}],"key":"cSPQVJ8Jiy"}],"key":"MN77ZBXil8"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# 類似度の上位単語を検索関数の実装\ndef most_similar(query, word_to_id, id_to_word, word_matrix, top=5):\n    \n    # 指定した単語がテキストに含まれないとき\n    if query not in word_to_id:\n        print('%s is not found' % query)\n        return\n    \n    # 対象の単語を表示\n    print('\\n[query] ' + query)\n    \n    # 指定した単語のIDを取得\n    query_id = word_to_id[query]\n    \n    # 指定した単語のベクトルを取得\n    query_vec = word_matrix[query_id]\n    \n    # コサイン類似度を計算\n    vocab_size = len(id_to_word)\n    similarity = np.zeros(vocab_size)\n    for i in range(vocab_size):\n        similarity[i] = cos_similarity(word_matrix[i], query_vec)\n    \n    # 類似度上位の単語と値を表示\n    count = 0 # 表示回数を初期化\n    for i in (-1 * similarity).argsort():\n        \n        # 指定した単語のときは次の単語に移る\n        if id_to_word[i] == query:\n            continue\n        \n        # 単語と値を表示\n        print(' %s: %s' % (id_to_word[i], similarity[i]))\n        \n        # 指定した回数に達したら処理を終了\n        count += 1 # 表示回数を加算\n        if count >= top:\n            return","key":"YQ9S75HVQQ"},{"type":"outputs","id":"eWzZO98GhgIshlqqsAXRv","children":[],"key":"fNIcVIGG3F"}],"key":"hMDxcfCSEv"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# クエリを指定\nquery = 'you'\n\n# 類似の単語を表示\nmost_similar(query, word_to_id, id_to_word, word_matrix, top=5)","key":"Ars5VAEtCi"},{"type":"outputs","id":"nlky1a-I8dW95l7vh7S2s","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"\n[query] you\n goodbye: 0.7071067691154799\n i: 0.7071067691154799\n hello: 0.7071067691154799\n say: 0.0\n and: 0.0\n"},"children":[],"key":"DlqfmI7uCd"}],"key":"bcCxWouRqY"}],"key":"JEP6Pe17pr"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"カウントベースの手法の改善","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"giee1thSgp"}],"identifier":"id","label":"カウントベースの手法の改善","html_id":"id-9","implicit":true,"enumerator":"3","key":"hHF8mnhTWT"}],"key":"VcUrRLvviz"},{"type":"block","kind":"notebook-content","children":[{"type":"admonition","kind":"custom","class":"dropdown tohokupurple","icon":"question","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"情報量の定義","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"zReKvuFSrf"}],"key":"mpbY7crZrH"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"事象","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"jE82FCXwVo"},{"type":"inlineMath","value":"x","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"QnEi28AEHI"},{"type":"text","value":"の生起確率","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"FG634fHyaO"},{"type":"inlineMath","value":"p(x)","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>p</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">p(x)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span></span>","key":"B2uGC9M3YF"},{"type":"text","value":"を基にして情報量","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"NHgxpFHLhv"},{"type":"inlineMath","value":"I(x)","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>I</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">I(x)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">I</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span></span>","key":"rxXyaVHjaS"},{"type":"text","value":"は","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"LmP8aix7qZ"},{"type":"inlineMath","value":"I(x) = - \\log_2 p(x)","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>I</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mo>−</mo><msub><mrow><mi>log</mi><mo>⁡</mo></mrow><mn>2</mn></msub><mi>p</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">I(x) = - \\log_2 p(x)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">I</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">−</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\"><span class=\"mop\">lo<span style=\"margin-right:0.01389em;\">g</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.207em;\"><span style=\"top:-2.4559em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2441em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span></span>","key":"bZ7yrKoSCn"},{"type":"text","value":"になります。","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"sPlyYrTGnK"},{"type":"inlineMath","value":"0 \\leq p(x) \\leq 1","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>0</mn><mo>≤</mo><mi>p</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>≤</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">0 \\leq p(x) \\leq 1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7804em;vertical-align:-0.136em;\"></span><span class=\"mord\">0</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"UzSCQJkYcO"},{"type":"text","value":"なので、","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"hzthqcpNzq"},{"type":"inlineMath","value":"\\log p(x)","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>log</mi><mo>⁡</mo><mi>p</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\log p(x)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mop\">lo<span style=\"margin-right:0.01389em;\">g</span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span></span>","key":"rZrSlBfwzI"},{"type":"text","value":"は常に負の値になる。よって符号を反転した値を情報量とすることで、常に正の値をとるようにする。","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"N5icfcJxTA"},{"type":"inlineMath","value":"log","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>l</mi><mi>o</mi><mi>g</mi></mrow><annotation encoding=\"application/x-tex\">log</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span></span></span></span>","key":"XEbTA2jxnc"},{"type":"text","value":"の底が","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"shLEVS4Y2Z"},{"type":"text","value":"2","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"WkSQFz7q3T"},{"type":"text","value":"なのは、情報学分野において0と1からなるbitとの相性からよく使われるためである。","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"ierAbKzwg1"}],"key":"tRXb1nm3z8"}],"key":"Yfbgy6NFHK"}],"key":"m53DgQ363J"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"相互情報量","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"rtckH52Gyh"}],"identifier":"id","label":"相互情報量","html_id":"id-10","implicit":true,"enumerator":"3.1","key":"rbHTfBppJs"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"ここまでは単語がテキストに出現する頻度そのままを扱いましたが、このやり方によって単語分散を計測する際、高頻度単語によるバイアスは生じる可能性があります。","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"sm7QPsD7js"}],"key":"RnPFdNLsXe"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"例えば、日本語において、「の」は非常に一般的な助詞で、さまざまな文脈で使用されます。単語の共起行列を作成するとき、「の」は非常に頻繁に出現し、多くの異なる単語とペアを形成するため、単純な共起頻度はその単語の意味のある関連性を捉えるのには不十分です。","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"O7UWHdnNTQ"}],"key":"uSaNtYNP9D"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"そのような問題を解決するために、相互情報量(Pointwise Mutual Information)と呼ばれる指標が使われます。","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"KIF11GkOu3"}],"key":"vFOdw2EVYZ"}],"key":"uqjWIQP8O6"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"2つの単語","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"csOP61Ac0B"},{"type":"inlineMath","value":"x","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"znMZdZcTf6"},{"type":"text","value":",","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"cnfWPWt0mt"},{"type":"inlineMath","value":"y","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span>","key":"lS4jr2lQ7S"},{"type":"text","value":"の出現確率をそれぞれ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"yoXLnwSDnc"},{"type":"inlineMath","value":"P(x)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>P</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">P(x)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span></span>","key":"yTUUAmIQwH"},{"type":"text","value":",","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"vesfMP1M7s"},{"type":"inlineMath","value":"P(y)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>P</mi><mo stretchy=\"false\">(</mo><mi>y</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">P(y)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\">)</span></span></span></span>","key":"l95B7Zs0x2"},{"type":"text","value":"とします。","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"PoU57asH4o"},{"type":"inlineMath","value":"x","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"zLFKN4ecMJ"},{"type":"text","value":"の出現確率は","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"GE9d1cPfHt"}],"key":"NEY81f4Bly"},{"type":"math","value":"P(x)\n    = \\frac{C(x)}{N}","position":{"start":{"line":3,"column":1},"end":{"line":6,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>P</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mfrac><mrow><mi>C</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><mi>N</mi></mfrac></mrow><annotation encoding=\"application/x-tex\">P(x)\n    = \\frac{C(x)}{N}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.113em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.427em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></span>","enumerator":"3","key":"FBRSWUscTb"},{"type":"paragraph","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"で計算します。ここで","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"pg9yNQisxG"},{"type":"inlineMath","value":"C(x)","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>C</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">C(x)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span></span>","key":"fjLuVxgLHc"},{"type":"text","value":"は単語","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"pMpwEp3c7E"},{"type":"inlineMath","value":"x","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"QiCFLhQGFM"},{"type":"text","value":"が(テキストではなく)コーパス(共起行列)にカウントされた回数、","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"s6H8MYvy3c"},{"type":"inlineMath","value":"N","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span>","key":"a2ibWA0hAo"},{"type":"text","value":"はコーパスの総単語数とします。","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"xyZzi7TeSr"}],"key":"BaaPE3q5cy"},{"type":"paragraph","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"また単語","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"WApe76FH6i"},{"type":"inlineMath","value":"x","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"AgimqjzPrb"},{"type":"text","value":",","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"HtOHIeuHM8"},{"type":"inlineMath","value":"y","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span>","key":"vv5svY7vA6"},{"type":"text","value":"が共起(ウィンドウサイズ内で続けて出現)した回数を","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"Di3Pao3Rr7"},{"type":"inlineMath","value":"C(x,y)","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>C</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo separator=\"true\">,</mo><mi>y</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">C(x,y)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\">)</span></span></span></span>","key":"hmGAF6c0aG"},{"type":"text","value":"とします。","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"bLKLyVrhVQ"}],"key":"WuxoZOIY8t"},{"type":"math","value":"P(x, y)\n    = \\frac{C(x, y)}{N}","position":{"start":{"line":12,"column":1},"end":{"line":15,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>P</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo separator=\"true\">,</mo><mi>y</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mfrac><mrow><mi>C</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo separator=\"true\">,</mo><mi>y</mi><mo stretchy=\"false\">)</mo></mrow><mi>N</mi></mfrac></mrow><annotation encoding=\"application/x-tex\">P(x, y)\n    = \\frac{C(x, y)}{N}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.113em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.427em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\">)</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></span>","enumerator":"4","key":"rlpcqYsSZV"},{"type":"paragraph","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"これを用いて、単語","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"mx7rNe5Lky"},{"type":"inlineMath","value":"x","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"msf5lpWabX"},{"type":"text","value":",","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"tHIx93LRP1"},{"type":"inlineMath","value":"y","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span>","key":"EW9rjjS2Ng"},{"type":"text","value":"の相互情報量(PMI)は次のように定義されます。","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"rB8BO9cU1N"}],"key":"bGNQJMtmUZ"},{"type":"math","value":"\\mathrm{PMI}(x, y)\n    = \\log_2 \\frac{\n          P(x, y)\n      }{\n          P(x) P(y)\n      }","position":{"start":{"line":19,"column":1},"end":{"line":26,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mrow><mi mathvariant=\"normal\">P</mi><mi mathvariant=\"normal\">M</mi><mi mathvariant=\"normal\">I</mi></mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo separator=\"true\">,</mo><mi>y</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msub><mrow><mi>log</mi><mo>⁡</mo></mrow><mn>2</mn></msub><mfrac><mrow><mi>P</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo separator=\"true\">,</mo><mi>y</mi><mo stretchy=\"false\">)</mo></mrow><mrow><mi>P</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mi>P</mi><mo stretchy=\"false\">(</mo><mi>y</mi><mo stretchy=\"false\">)</mo></mrow></mfrac></mrow><annotation encoding=\"application/x-tex\">\\mathrm{PMI}(x, y)\n    = \\log_2 \\frac{\n          P(x, y)\n      }{\n          P(x) P(y)\n      }</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathrm\">PMI</span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.363em;vertical-align:-0.936em;\"></span><span class=\"mop\"><span class=\"mop\">lo<span style=\"margin-right:0.01389em;\">g</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.207em;\"><span style=\"top:-2.4559em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2441em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.427em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\">)</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\">)</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.936em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></span>","enumerator":"5","key":"DjOk5XaBVf"},{"type":"paragraph","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"children":[{"type":"text","value":"またこの式は、次のように変形することで","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"XotOMFnAey"}],"key":"Lnxcvcd2Wu"},{"type":"math","value":"\\begin{align}\n\\mathrm{PMI}(x, y)\n   &= \\log_2 \\left(\n          P(x, y)\n          \\frac{1}{P(x)}\n          \\frac{1}{P(y)}\n      \\right)\n\\\\\n   &= \\log_2 \\left( \n          \\frac{C(x, y)}{N}\n          \\frac{N}{C(x)}\n          \\frac{N}{C(y)}\n      \\right)\n\\\\\n   &= \\log_2 \\frac{\n          C(x, y) N\n      }{\n          C(x) C(y)\n      }\n\\end{align}","position":{"start":{"line":30,"column":1},"end":{"line":51,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mtable rowspacing=\"0.25em\" columnalign=\"right left\" columnspacing=\"0em\"><mtr><mtd class =\"mtr-glue\"></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow><mi mathvariant=\"normal\">P</mi><mi mathvariant=\"normal\">M</mi><mi mathvariant=\"normal\">I</mi></mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo separator=\"true\">,</mo><mi>y</mi><mo stretchy=\"false\">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>=</mo><msub><mrow><mi>log</mi><mo>⁡</mo></mrow><mn>2</mn></msub><mrow><mo fence=\"true\">(</mo><mi>P</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo separator=\"true\">,</mo><mi>y</mi><mo stretchy=\"false\">)</mo><mfrac><mn>1</mn><mrow><mi>P</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></mfrac><mfrac><mn>1</mn><mrow><mi>P</mi><mo stretchy=\"false\">(</mo><mi>y</mi><mo stretchy=\"false\">)</mo></mrow></mfrac><mo fence=\"true\">)</mo></mrow></mrow></mstyle></mtd><mtd class =\"mtr-glue\"></mtd><mtd class =\"mml-eqn-num\"></mtd></mtr><mtr><mtd class =\"mtr-glue\"></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>=</mo><msub><mrow><mi>log</mi><mo>⁡</mo></mrow><mn>2</mn></msub><mrow><mo fence=\"true\">(</mo><mfrac><mrow><mi>C</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo separator=\"true\">,</mo><mi>y</mi><mo stretchy=\"false\">)</mo></mrow><mi>N</mi></mfrac><mfrac><mi>N</mi><mrow><mi>C</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></mfrac><mfrac><mi>N</mi><mrow><mi>C</mi><mo stretchy=\"false\">(</mo><mi>y</mi><mo stretchy=\"false\">)</mo></mrow></mfrac><mo fence=\"true\">)</mo></mrow></mrow></mstyle></mtd><mtd class =\"mtr-glue\"></mtd><mtd class =\"mml-eqn-num\"></mtd></mtr><mtr><mtd class =\"mtr-glue\"></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>=</mo><msub><mrow><mi>log</mi><mo>⁡</mo></mrow><mn>2</mn></msub><mfrac><mrow><mi>C</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo separator=\"true\">,</mo><mi>y</mi><mo stretchy=\"false\">)</mo><mi>N</mi></mrow><mrow><mi>C</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mi>C</mi><mo stretchy=\"false\">(</mo><mi>y</mi><mo stretchy=\"false\">)</mo></mrow></mfrac></mrow></mstyle></mtd><mtd class =\"mtr-glue\"></mtd><mtd class =\"mml-eqn-num\"></mtd></mtr></mtable><annotation encoding=\"application/x-tex\">\\begin{align}\n\\mathrm{PMI}(x, y)\n   &amp;= \\log_2 \\left(\n          P(x, y)\n          \\frac{1}{P(x)}\n          \\frac{1}{P(y)}\n      \\right)\n\\\\\n   &amp;= \\log_2 \\left( \n          \\frac{C(x, y)}{N}\n          \\frac{N}{C(x)}\n          \\frac{N}{C(y)}\n      \\right)\n\\\\\n   &amp;= \\log_2 \\frac{\n          C(x, y) N\n      }{\n          C(x) C(y)\n      }\n\\end{align}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:8.0631em;vertical-align:-3.7815em;\"></span><span class=\"mtable\"><span class=\"col-align-r\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:4.2815em;\"><span style=\"top:-6.2815em;\"><span class=\"pstrut\" style=\"height:3.45em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathrm\">PMI</span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\">)</span></span></span><span style=\"top:-3.5815em;\"><span class=\"pstrut\" style=\"height:3.45em;\"></span><span class=\"mord\"></span></span><span style=\"top:-0.9045em;\"><span class=\"pstrut\" style=\"height:3.45em;\"></span><span class=\"mord\"></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.7815em;\"><span></span></span></span></span></span><span class=\"col-align-l\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:4.2815em;\"><span style=\"top:-6.2815em;\"><span class=\"pstrut\" style=\"height:3.45em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mop\"><span class=\"mop\">lo<span style=\"margin-right:0.01389em;\">g</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.207em;\"><span style=\"top:-2.4559em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2441em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">(</span></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\">)</span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3214em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.936em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3214em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\">)</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.936em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">)</span></span></span></span></span><span style=\"top:-3.5815em;\"><span class=\"pstrut\" style=\"height:3.45em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mop\"><span class=\"mop\">lo<span style=\"margin-right:0.01389em;\">g</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.207em;\"><span style=\"top:-2.4559em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2441em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">(</span></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.427em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\">)</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3603em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.936em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3603em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\">)</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.936em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">)</span></span></span></span></span><span style=\"top:-0.9045em;\"><span class=\"pstrut\" style=\"height:3.45em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mop\"><span class=\"mop\">lo<span style=\"margin-right:0.01389em;\">g</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.207em;\"><span style=\"top:-2.4559em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2441em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.427em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\">)</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\">)</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.936em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.7815em;\"><span></span></span></span></span></span></span></span><span class=\"tag\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:4.2815em;\"><span style=\"top:-6.2815em;\"><span class=\"pstrut\" style=\"height:3.45em;\"></span><span class=\"eqn-num\"></span></span><span style=\"top:-3.5815em;\"><span class=\"pstrut\" style=\"height:3.45em;\"></span><span class=\"eqn-num\"></span></span><span style=\"top:-0.9045em;\"><span class=\"pstrut\" style=\"height:3.45em;\"></span><span class=\"eqn-num\"></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.7815em;\"><span></span></span></span></span></span></span></span></span>","enumerator":"6","key":"VPuM5QaZuv"},{"type":"paragraph","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"children":[{"type":"text","value":"出現回数と総単語数から直接で計算できることが分かります。","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"ZkOApZ6n7O"}],"key":"ou8Pz24YbM"},{"type":"paragraph","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"children":[{"type":"text","value":"ただし出現回数が0のときに不都合が生じるため、次の正の相互情報量(PPMI)を用います。","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"key":"HsgOmvImhO"}],"key":"nM3RYyNBi1"},{"type":"math","value":"\\mathrm{PPMI}(x, y)\n    = \\max(0, \\mathrm{PMI}(x, y))","position":{"start":{"line":57,"column":1},"end":{"line":60,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mrow><mi mathvariant=\"normal\">P</mi><mi mathvariant=\"normal\">P</mi><mi mathvariant=\"normal\">M</mi><mi mathvariant=\"normal\">I</mi></mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo separator=\"true\">,</mo><mi>y</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi>max</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><mn>0</mn><mo separator=\"true\">,</mo><mrow><mi mathvariant=\"normal\">P</mi><mi mathvariant=\"normal\">M</mi><mi mathvariant=\"normal\">I</mi></mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo separator=\"true\">,</mo><mi>y</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\mathrm{PPMI}(x, y)\n    = \\max(0, \\mathrm{PMI}(x, y))</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathrm\">PPMI</span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mop\">max</span><span class=\"mopen\">(</span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathrm\">PMI</span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\">))</span></span></span></span></span>","enumerator":"7","key":"DksS4MITbY"}],"key":"LQwnvbGZn9"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from tqdm.notebook import tqdm\n# 相互情報量行列の作成関数の実装\ndef ppmi(C, verbose=False, eps=1e-8):\n    \n    # PPMI行列の受け皿を作成\n    M = np.zeros_like(C, dtype=np.float32)\n    \n    # PPMIに用いる値を計算\n    N = np.sum(C) # 総単語数\n    S = np.sum(C, axis=0) # 各単語の出現回数\n    \n    # 進行状況確認用の値を計算\n    total = C.shape[0] * C.shape[1]\n    cnt = 0 # 処理回数を初期化\n    \n    # 1語ずつ正の相互情報量を計算\n    for i in tqdm(range(C.shape[0])): # 各行\n        for j in range(C.shape[1]): # 各列\n            \n            # PPMIを計算\n            pmi = np.log2(C[i, j] * N / (S[j] * S[i]) + eps)\n            M[i, j] = max(0, pmi)\n    \n    return M","key":"bPfQNwe9OP"},{"type":"outputs","id":"Jt6LwBedJcvXtOyyxdLcL","children":[],"key":"heHG9M0NNH"}],"key":"OapjFGpZhA"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# 共起行列を作成\nC = create_co_matrix(corpus, vocab_size, window_size=1)\nprint(C)\n\nW = ppmi(C, verbose=True)\n\n\n# 正の相互情報量行列\nprint(np.round(W, 2))","key":"Ik8lIyRtxw"},{"type":"outputs","id":"_xDkgBvEtUZTuWhSt96sm","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"[[0 1 0 0 0 0 0]\n [1 0 1 0 1 1 0]\n [0 1 0 1 0 0 0]\n [0 0 1 0 1 0 0]\n [0 1 0 1 0 0 0]\n [0 1 0 0 0 0 1]\n [0 0 0 0 0 1 0]]\n"},"children":[],"key":"JySyrChhpf"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"application/vnd.jupyter.widget-view+json":{"content":"{\"model_id\":\"4cdc5816352a4f65b56f624e7f07928d\",\"version_major\":2,\"version_minor\":0}","content_type":"application/vnd.jupyter.widget-view+json"},"text/plain":{"content":"  0%|          | 0/7 [00:00<?, ?it/s]","content_type":"text/plain"}}},"children":[],"key":"LdvjapttIU"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"[[0.   1.81 0.   0.   0.   0.   0.  ]\n [1.81 0.   0.81 0.   0.81 0.81 0.  ]\n [0.   0.81 0.   1.81 0.   0.   0.  ]\n [0.   0.   1.81 0.   1.81 0.   0.  ]\n [0.   0.81 0.   1.81 0.   0.   0.  ]\n [0.   0.81 0.   0.   0.   0.   2.81]\n [0.   0.   0.   0.   0.   2.81 0.  ]]\n"},"children":[],"key":"l3319EMyBX"}],"key":"A8QQhAmGpg"}],"key":"hyjUbV2y8b"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"次元削減","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"W2cu8eO5Wr"}],"identifier":"id","label":"次元削減","html_id":"id-11","implicit":true,"enumerator":"3.2","key":"MTm0u1THks"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"次元削減は、ベクトルの次元を重要な情報を保持しながら削減する手法を指します。","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"epuEDsOTyc"}],"key":"twbiPSrlum"}],"key":"qccH0KIXI3"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"SVD","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"K0I9W2kZP3"}],"identifier":"svd","label":"SVD","html_id":"svd","implicit":true,"enumerator":"3.2.1","key":"yePxaNW0gz"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"次元削減を行う方法はいくつかあります。ここでは特異値分解(Singular Value Decomposition:SVD)を使って次元削減を行います。","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"KsjUIW4Zqn"}],"key":"MsBxGcjOUj"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"SVDは、任意の行列を3つの行列の積へ分解します。","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"xwcUUxKjD9"}],"key":"kNsGXUbVYO"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"inlineMath","value":"A = U\\Sigma V^T","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>A</mi><mo>=</mo><mi>U</mi><mi mathvariant=\"normal\">Σ</mi><msup><mi>V</mi><mi>T</mi></msup></mrow><annotation encoding=\"application/x-tex\">A = U\\Sigma V^T</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">A</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8413em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">U</span><span class=\"mord\">Σ</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span></span></span></span>","key":"B8bmyWwLTI"}],"key":"b2oR7QzdyE"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"ここで、","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"uy6HZoqfYi"},{"type":"inlineMath","value":"A","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>A</mi></mrow><annotation encoding=\"application/x-tex\">A</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">A</span></span></span></span>","key":"n9Xzsvwv2s"},{"type":"text","value":"は","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"FyyWHVXqW5"},{"type":"inlineMath","value":"n \\times d","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo>×</mo><mi>d</mi></mrow><annotation encoding=\"application/x-tex\">n \\times d</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">d</span></span></span></span>","key":"bgwN2ScY7Z"},{"type":"text","value":"の行列、","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"rz00P6QM5T"},{"type":"inlineMath","value":"U","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>U</mi></mrow><annotation encoding=\"application/x-tex\">U</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">U</span></span></span></span>","key":"yEF2sXBhHx"},{"type":"text","value":"は","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"hGKPtEl6ya"},{"type":"inlineMath","value":"n \\times n","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo>×</mo><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n \\times n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"IUpWw9F39R"},{"type":"text","value":"、","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"DuEPHFZb9H"},{"type":"inlineMath","value":"V","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>V</mi></mrow><annotation encoding=\"application/x-tex\">V</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span></span></span></span>","key":"R3xYUWmB2O"},{"type":"text","value":"は","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"KBYuK88gEH"},{"type":"inlineMath","value":"d \\times d","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>d</mi><mo>×</mo><mi>d</mi></mrow><annotation encoding=\"application/x-tex\">d \\times d</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7778em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">d</span></span></span></span>","key":"MdhnNzFOwh"},{"type":"text","value":"の直交行列です。","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"fXRodu7mf9"}],"key":"Vc8jBYOmu4"}],"key":"z5gAtAi89m"},{"type":"block","kind":"notebook-content","children":[{"type":"admonition","kind":"custom","class":"dropdown tohokupurple","icon":"question","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"直交行列","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"BHjqlsyYVk"}],"key":"AjyTOvDgwS"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"直交行列とは、転置行列","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"QZeB1wfg9g"},{"type":"inlineMath","value":"A^T","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>A</mi><mi>T</mi></msup></mrow><annotation encoding=\"application/x-tex\">A^T</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8413em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">A</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span></span></span></span>","key":"kf7cQrnlML"},{"type":"text","value":"と逆行列","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"zLuvGaE6VG"},{"type":"inlineMath","value":"A^{-1}","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>A</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding=\"application/x-tex\">A^{-1}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">A</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span></span></span></span>","key":"Y1MMY2fXCX"},{"type":"text","value":"が等しくなる行列。直交行列の列ベクトル（または行ベクトル）は互いに直交し、かつ正規化されています（つまり、それぞれのベクトルの長さが1）。これは、直交行列が基底変換を行う際に、ベクトルの長さや角度を保持することを意味します。そのため、直交行列は主にベクトル空間の基底を変換する際や、回転や反射などの幾何学的変換を表現するのに用いられます。","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"SRvf3bu3Xr"}],"key":"Rnu5Hp57YM"}],"key":"MRBDASIUEs"}],"key":"giTCIM5HRl"},{"type":"block","kind":"notebook-content","children":[{"type":"image","url":"/build/svd-85c4fbb5ae5e93c592eeabba79f07f63.png","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"tz1OzwD1oN","urlSource":"./Figure/svd.png"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"inlineMath","value":"U","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>U</mi></mrow><annotation encoding=\"application/x-tex\">U</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">U</span></span></span></span>","key":"o0MyY6V5hg"},{"type":"text","value":"は何らかの空間の基底を形成しています。ここは、","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ewyaMK576Y"},{"type":"inlineMath","value":"U","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>U</mi></mrow><annotation encoding=\"application/x-tex\">U</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">U</span></span></span></span>","key":"Q3pViVJ8Ne"},{"type":"text","value":"という行列を「単語空間」として扱うことができます。","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"uuaQYXEBCt"}],"key":"fWTGf8nUJH"}],"key":"EVBisoLekz"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"inlineMath","value":"\\Sigma","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">Σ</mi></mrow><annotation encoding=\"application/x-tex\">\\Sigma</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord\">Σ</span></span></span></span>","key":"Erq9R3HdFy"},{"type":"text","value":"は対角行列で、この対角成分には、「特異値」というものが大きい順で並んでいます。ここで、「特異値」は対応する軸の重要度とみなすことができます。次元削減は、この情報によって重要でない要素を削除することが考えれます。","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"bSi1w0f6ek"}],"key":"Djq2IqEVS6"}],"key":"BUW6PureTB"}],"key":"qSmOG2HQhL"}],"key":"eydm0zBlkI"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"SVDによって、疎なベクトルが密なベクトルへ変換されています。この密なベクトルから、先頭の二つの要素を取り出すことで、元のベクトルの「情報」をできるだけ保持しながら次元を削減することができます。","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Bohg05uSci"}],"key":"XN0E9CTxsd"}],"key":"e29N6EGrwk"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"U, S, V = np.linalg.svd(W)\n\nprint(C[0]) # 共起行列\nprint(W[0]) # PPMI行列\nprint(U[0]) # SVD","key":"CwAeiVrd72"},{"type":"outputs","id":"Gnwyd_TVufcHiZ11qex2H","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"[0 1 0 0 0 0 0]\n[0.        1.8073549 0.        0.        0.        0.        0.       ]\n[ 0.0000000e+00 -3.4094876e-01 -3.8857806e-16  1.2051624e-01\n  9.3232495e-01 -1.1102230e-16  3.2068993e-16]\n"},"children":[],"key":"mwUG4AqFct"}],"key":"wntFBqCOcr"}],"key":"GFt6hYcA85"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"カウントベースの手法による単語分散の作成","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ehGje50XtA"}],"identifier":"id","label":"カウントベースの手法による単語分散の作成","html_id":"id-12","implicit":true,"enumerator":"4","key":"OIzaHUzyOr"}],"key":"sYKY9jxW0F"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import re\nimport pickle\n\nwith open(\"./Data/dokujo-tsushin.txt\", mode=\"r\",encoding=\"utf-8\") as f:\n    corpus = []\n    for line in f:\n        cleaned_line = line.replace('\\u3000', '').replace('\\n', '')\n        if cleaned_line!=\"\":\n            corpus.append(cleaned_line)","key":"cQQHVvwrIJ"},{"type":"outputs","id":"fdKoKI7dyAPru9YUqPJBP","children":[],"key":"R27gC3qChx"}],"key":"nwAErnzRke"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"corpus[:5]","key":"RFKkgQd3mb"},{"type":"outputs","id":"WTzUGOPwLKeHJg-np4QRo","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":35,"metadata":{},"data":{"text/plain":{"content":"['  友人代表のスピーチ、独女はどうこなしている？',\n 'もうすぐジューン・ブライドと呼ばれる６月。独女の中には自分の式はまだなのに呼ばれてばかり……という「お祝い貧乏」状態の人も多いのではないだろうか？さらに出席回数を重ねていくと、こんなお願いごとをされることも少なくない。',\n '「お願いがあるんだけど……友人代表のスピーチ、やってくれないかな？」',\n 'さてそんなとき、独女はどう対応したらいいか？',\n '最近だとインターネット等で検索すれば友人代表スピーチ用の例文サイトがたくさん出てくるので、それらを参考にすれば、無難なものは誰でも作成できる。しかし由利さん（33歳）はネットを参考にして作成したものの「これで本当にいいのか不安でした。一人暮らしなので聞かせて感想をいってくれる人もいないし、かといって他の友人にわざわざ聞かせるのもどうかと思うし……」ということで活用したのが、なんとインターネットの悩み相談サイトに。そこに作成したスピーチ文を掲載し「これで大丈夫か添削してください」とメッセージを送ったというのである。']","content_type":"text/plain"}}},"children":[],"key":"qSI2VM4uKO"}],"key":"LhcnglAXuQ"}],"key":"UsNfeqcQya"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"#!pip install mecab-python3\n#!pip install unidic-lite","key":"tNZULYM7Ox"},{"type":"outputs","id":"XXjFXlIvGxHvagT8jC9X4","children":[],"key":"xPlkLh4uIm"}],"key":"scQoUMOh91"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import MeCab\nfrom tqdm.notebook import tqdm\ndef tokenize_with_mecab(sentences):\n    # Initialize MeCab with the specified dictionary\n    corpus = []\n    for sentence in sentences:\n        sentence = re.sub(\"http://news.livedoor.com/article/detail/[0-9]{7}/\",\"\", sentence) # 注2）\n        sentence = re.sub(\"[0-9]{4}-[0-9]{2}-[0-9]{2}T[0-9]{2}:[0-9]{2}:[0-9]{2}\\+[0-9]{4}\",\"\", sentence) # 注3）\n        sentence = re.sub(\"[「」]\",\"\", sentence)\n        # Parse the sentence\n        node = mecab.parseToNode(sentence)\n        # Iterate over all nodes\n        while node:\n            # Extract the surface form of the word\n            word = node.surface\n            # Skip empty words and add to the corpus\n            if word:\n                corpus.append(word)\n            node = node.next\n    return corpus\n\n\n# Initialize the MeCab tokenizer\nmecab = MeCab.Tagger()\n#path = \"-d /opt/homebrew/lib/mecab/dic/mecab-ipadic-neologd\"\n#mecab = MeCab.Tagger(path)\ncorpus = tokenize_with_mecab(corpus)","key":"X9wsu8qele"},{"type":"outputs","id":"LhOAgrr5EEFwo83p4OSsa","children":[{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"<>:8: SyntaxWarning: invalid escape sequence '\\+'\n<>:8: SyntaxWarning: invalid escape sequence '\\+'\n/var/folders/0s/grknnvt93bs7w2rbrt894wkc0000gn/T/ipykernel_13865/2217006374.py:8: SyntaxWarning: invalid escape sequence '\\+'\n  sentence = re.sub(\"[0-9]{4}-[0-9]{2}-[0-9]{2}T[0-9]{2}:[0-9]{2}:[0-9]{2}\\+[0-9]{4}\",\"\", sentence) # 注3）\n"},"children":[],"key":"NrixJM5aLD"}],"key":"vVXQLMIf24"}],"key":"UhZ8nUBdem"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"corpus[:10]","key":"A1O2liHKZw"},{"type":"outputs","id":"kg3POKxeMblv4TAnD8hQz","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":38,"metadata":{},"data":{"text/plain":{"content":"['友人', '代表', 'の', 'スピーチ', '、', '独女', 'は', 'どう', 'こなし', 'て']","content_type":"text/plain"}}},"children":[],"key":"NUdwioxPQd"}],"key":"VBsiD9paji"}],"key":"yidHwHhTSE"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"word_to_id = {}\nid_to_word = {}\n\nfor word in corpus:\n    if word not in word_to_id:\n        new_id = len(word_to_id)\n        word_to_id[word] = new_id\n        id_to_word[new_id] = word\n        \nprint('id_to_word[0]:', id_to_word[0])\nprint('id_to_word[1]:', id_to_word[1])\nprint('id_to_word[2]:', id_to_word[2])\nprint()\nprint(\"word_to_id['女']:\", word_to_id['女'])\nprint(\"word_to_id['結婚']:\", word_to_id['結婚'])\nprint(\"word_to_id['夫']:\", word_to_id['夫'])","key":"cpXy2lt1B2"},{"type":"outputs","id":"Cm9L3SsOhDneVwoN34NF7","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"id_to_word[0]: 友人\nid_to_word[1]: 代表\nid_to_word[2]: の\n\nword_to_id['女']: 3163\nword_to_id['結婚']: 148\nword_to_id['夫']: 1426\n"},"children":[],"key":"dRtx0C7SFY"}],"key":"tOouknQvlk"}],"key":"rTvyueqxIc"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# リストに変換\ncorpus = [word_to_id[word] for word in corpus]\n\n# NumPy配列に変換\ncorpus = np.array(corpus)","key":"kSPjx9nm5z"},{"type":"outputs","id":"sf8khi-zz917FTMPROwld","children":[],"key":"WYtBok6T2W"}],"key":"GdNnMQDDg0"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"vocab_size=len(word_to_id)\nvocab_size","key":"Quj3UG9Uu6"},{"type":"outputs","id":"Oql3XVERJ0VwwtkHDyqb-","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":41,"metadata":{},"data":{"text/plain":{"content":"25547","content_type":"text/plain"}}},"children":[],"key":"tLwCWm38ET"}],"key":"aTXMZSessW"}],"key":"NQuk7Pyxqi"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"window_size = 2\nwordvec_size = 100\nvocab_size = len(word_to_id)","key":"cyKMeXM1eW"},{"type":"outputs","id":"OwqI2vuaQRB97hUuQRXtI","children":[],"key":"geWFumvCaU"}],"key":"rR3YmStwr2"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"C=create_co_matrix(corpus,vocab_size,window_size=window_size)","key":"qPLxMkQQ5K"},{"type":"outputs","id":"VLE1yXolElHe9Z8-5e5K4","children":[],"key":"oU5Xz7aovZ"}],"key":"AMAH1jA1Ml"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"#W = ppmi(C)\n#np.save('./Data/W.npy', W)\nW = np.load('./Data/W.npy')","key":"HSMbP5ikxf"},{"type":"outputs","id":"u-V9ns5-auar7d7D1OqEj","children":[],"key":"SJdysSiWjh"}],"key":"mntGn3qiZZ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from sklearn.utils.extmath import randomized_svd\nU, S, V= randomized_svd(W,n_components=wordvec_size,n_iter=5,random_state=None)","key":"JRDjM2Ti0h"},{"type":"outputs","id":"jRBbKxwzB8tCKH7jeXMcC","children":[],"key":"ULLfM6UOIY"}],"key":"ugvmzOXzse"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"word_vecs=U[:, :wordvec_size]","key":"vbN5rz88kX"},{"type":"outputs","id":"YLsx98LUeTwClJk0QpwPb","children":[],"key":"J9YZG57EBs"}],"key":"C0XSktjmZX"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"querys = ['女', '結婚', '彼女', \"秋\"]\n\nfor query in querys:\n    most_similar(query, word_to_id, id_to_word, word_vecs, top=5)","key":"r8ow79CMFj"},{"type":"outputs","id":"WEQjR3lWQi6KcxB0_flSD","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"\n[query] 女\n デブ: 0.7226879000663757\n 頼りがい: 0.7069697380065918\n 技: 0.7065211534500122\n 結ば: 0.6929681897163391\n 市民: 0.683417797088623\n\n[query] 結婚\n 縁組: 0.7332433462142944\n 正子: 0.6813077926635742\n 切迫: 0.6812717318534851\n 久仁子: 0.6402035355567932\n 後押し: 0.6352586150169373\n\n[query] 彼女\n 土地: 0.8677912950515747\n つかわ: 0.8450607657432556\n ソテー: 0.8422375917434692\n 強がり: 0.8376142382621765\n まね: 0.8207266330718994\n\n[query] 秋\n 館: 0.514491081237793\n おわ: 0.5090659856796265\n 切らさ: 0.4935395121574402\n 食後: 0.4698116183280945\n 交渉: 0.4658271074295044\n"},"children":[],"key":"uoyQEqcOXB"}],"key":"dgIw1BIwoP"}],"key":"cHLwSqAa6g"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"おまけ：Pytorchでの実装","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"YUjFrUUhos"}],"identifier":"id-pytorch","label":"おまけ：Pytorchでの実装","html_id":"id-pytorch","implicit":true,"enumerator":"4.1","key":"wlnKRpx6Lo"}],"key":"OqnyGKkXtq"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import torch\ntorch.backends.mps.is_available()\n\ndef ppmi_torch(C, eps=1e-8):\n    device = torch.device(\"mps\" if torch.backends.mps.is_available() else \"cuda\" if torch.cuda.is_available() else \"cpu\")\n    C = torch.tensor(C, dtype=torch.float32, device=device)\n    \n    # 総単語数と各単語の出現頻度を計算\n    N = torch.sum(C)\n    S = torch.sum(C, dim=0, keepdim=True)  # 各単語の出現回数（列方向）\n    \n    # PPMIの計算（ループなし）\n    pmi = torch.log2(C * N / (S.t() * S) + eps)  # PMI行列を一括計算\n    M = torch.max(pmi, torch.tensor(0.0, device=device))  # PPMI行列を計算\n    \n    return M  # 必要であればCPUに戻す","key":"cxyWl1pmvH"},{"type":"outputs","id":"vYjeoG1E_r6emXF4rd8N8","children":[],"key":"w5TJZ10f6s"}],"key":"QoiXQO2rbO"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"W = ppmi_torch(C)","key":"xt4dsWlfvN"},{"type":"outputs","id":"9QskVlA_22q17HLHywDd6","children":[],"key":"xaPenIhuOi"}],"key":"xEsccgUaMe"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from sklearn.utils.extmath import randomized_svd\nU, S, V= randomized_svd(W.cpu().numpy(),n_components=wordvec_size,n_iter=5,random_state=None)","key":"RqLXWogCVp"},{"type":"outputs","id":"tffHehsqCEM4SJjCjeVal","children":[],"key":"EnyJLpRKRB"}],"key":"R9HwYPo2Ep"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"word_vecs=U[:, :wordvec_size]","key":"vcIHgIbAit"},{"type":"outputs","id":"CMzCplBFIgdDxIMZpCco5","children":[],"key":"uRO3OTNm6J"}],"key":"cGzXSFnSjV"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"querys = ['女', '結婚', '彼女', \"秋\"]\n\nfor query in querys:\n    most_similar(query, word_to_id, id_to_word, word_vecs, top=5)","key":"YL4Iu7SYVi"},{"type":"outputs","id":"PrjKqeZ7K7hfdgLkOV7Hl","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"\n[query] 女\n 男: 0.7777467966079712\n 男子: 0.5937835574150085\n 独女: 0.5688649415969849\n 男性: 0.5374248027801514\n 女性: 0.5247462391853333\n\n[query] 結婚\n 離婚: 0.6396859288215637\n 交際: 0.5854832530021667\n 迎え: 0.5492004156112671\n 入籍: 0.5393035411834717\n 出産: 0.5391035676002502\n\n[query] 彼女\n 彼: 0.7317190170288086\n 娘: 0.610599935054779\n 夫: 0.6025635600090027\n 友人: 0.6021445989608765\n 母親: 0.5997404456138611\n\n[query] 秋\n 春: 0.7465042471885681\n 夏: 0.7199810743331909\n 冬: 0.6601986289024353\n フェス: 0.659843921661377\n 季節: 0.6529552936553955\n"},"children":[],"key":"NrtrDE7JNC"}],"key":"WO8QpYyUEe"}],"key":"yoMyBSwMR6"}],"key":"Rebd0CC2bs"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Pytorch","url":"/pytorch2","group":"PyTorch"},"next":{"title":"word2vec","url":"/word2vec-2-embedding","group":"単語分散表現"}}},"domain":"http://localhost:3000"}