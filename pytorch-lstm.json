{"version":3,"kind":"Notebook","sha256":"4fdca3aacd08163ecf128c84c75e48538c9d1e19558fcd5a31be4d27cd1f6d8f","slug":"pytorch-lstm","location":"/notebook/pytorch_lstm.ipynb","dependencies":[],"frontmatter":{"title":"LSTMの実装","content_includes_title":false,"kernelspec":{"name":"python3","display_name":"jupyterbook","language":"python"},"github":"https://github.com/lvzeyu/css_nlp","numbering":{"heading_1":{"enabled":true,"template":"enabled"},"heading_2":{"enabled":true,"template":"enabled"},"heading_3":{"enabled":true,"template":"enabled"},"heading_4":{"enabled":true,"template":"enabled"},"heading_5":{"enabled":true,"template":"enabled"},"heading_6":{"enabled":true,"template":"enabled"},"title":{"offset":1}},"source_url":"https://github.com/lvzeyu/css_nlp/blob/master/notebook/pytorch_lstm.ipynb","edit_url":"https://github.com/lvzeyu/css_nlp/edit/master/notebook/pytorch_lstm.ipynb","exports":[{"format":"ipynb","filename":"pytorch_lstm.ipynb","url":"/build/pytorch_lstm-b77a38b08d7f50d5822402223988501e.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"link","url":"https://pytorch.org/docs/stable/generated/torch.nn.LSTM.html","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"torch.nn.LSTM","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"f4vGUcxgeI"}],"urlSource":"https://pytorch.org/docs/stable/generated/torch.nn.LSTM.html","key":"wdIECZi3oT"}],"identifier":"torch-nn-lstm","label":"torch.nn.LSTM","html_id":"torch-nn-lstm","implicit":true,"enumerator":"1","key":"BCsdl11Kau"}],"key":"sENIptERDn"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"PyTorchの","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"NHd7IHZHNu"},{"type":"link","url":"https://pytorch.org/docs/stable/generated/torch.nn.LSTM.html","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"torch.nn.LSTM","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"LeK8K1bZvD"}],"urlSource":"https://pytorch.org/docs/stable/generated/torch.nn.LSTM.html","key":"MOtAIW8pyh"},{"type":"text","value":"クラスを使用して、LSTMをモデルに簡単にレイヤーとして追加できます。","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"zQLiPcWh3R"}],"key":"tLYV2UgDIl"}],"key":"Z2Q2ocr0Fu"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"inlineCode","value":"torch.nn.LSTM","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"rtvlvxgcK7"},{"type":"text","value":"の主なパラメータは以下の通りです：","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"lZk9H3TeK4"}],"key":"g86TzjpazG"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":4,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"input_size","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"kPDXiMcILm"},{"type":"text","value":"：入力xの特徴量の数","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"YhLJ1yifxY"}],"key":"KuxT60rgYO"}],"key":"UDqvCnvOEw"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"hidden_size","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"PZLwSROVIz"},{"type":"text","value":"：隠れ状態の特徴量の数","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"VSRtjtbxOV"}],"key":"sTuxCXTaGj"}],"key":"OOL5KBJhqU"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"num_layers","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"FtTDeFgZP3"},{"type":"text","value":"：LSTMを重ねる層の数（デフォルトは","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"nyWZ4ODSRC"},{"type":"text","value":"1","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"MVFLv4SldR"},{"type":"text","value":"）","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"Yqs7XWDzSh"}],"key":"bU3Qypyle3"}],"key":"OKaj91d8tw"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"bias","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"g8wy7Lq3z9"},{"type":"text","value":"：バイアスを使用するかどうか（デフォルトは","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"gi88y0cWwT"},{"type":"inlineCode","value":"True","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"Z7wKV2aliH"},{"type":"text","value":"）","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"I65lkBjpkP"}],"key":"RDzlGQroys"}],"key":"B2H4COA60K"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"batch_first","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"tXFUbZrGiB"},{"type":"text","value":"：入力と出力のテンソルの形状が(","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"w1k4Pfcptb"},{"type":"inlineCode","value":"batch","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"TKdF2Nq4BV"},{"type":"text","value":", ","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"pvwJxQtCBM"},{"type":"inlineCode","value":"seq","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"k0ZHlqOHPV"},{"type":"text","value":", ","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"ZuHYKV4PLV"},{"type":"inlineCode","value":"feature","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"r89hJ9PV7L"},{"type":"text","value":")になるようにするかどうか（デフォルトは","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"BKiJP9N6Zm"},{"type":"inlineCode","value":"False","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"u9ht7gRqsh"},{"type":"text","value":"）","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"e8QO7Nz3Vy"}],"key":"YNyUCPflOQ"}],"key":"Stb2BYP9sj"},{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"dropout","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"Y5fi3f9FH1"},{"type":"text","value":"：ドロップアウトを適用する確率（デフォルトは","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"nxS5OsG2FB"},{"type":"text","value":"0","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"h9yrKSoEfB"},{"type":"text","value":"、つまりドロップアウトなし）","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"hvSpXXgnLs"}],"key":"IEnEKypdAs"}],"key":"wLnZQVLwv0"},{"type":"listItem","spread":true,"position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"bidirectional","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"SvNWyWmwAY"},{"type":"text","value":"：双方向LSTMを使用するかどうか（デフォルトは","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"LdKrEu3VXr"},{"type":"inlineCode","value":"False","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"NCW8HMG9Eb"},{"type":"text","value":"）","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"gG00ULwmHw"}],"key":"zG0qEzSkzK"}],"key":"S1Rlu8qyKd"}],"key":"SeJ08uStFI"}],"key":"lHrqQnHhOs"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"入力","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Xfa3EiC0sz"}],"identifier":"id","label":"入力","html_id":"id","implicit":true,"enumerator":"2","key":"tRqdOQcVyC"}],"key":"GgeIZbh4wK"},{"type":"block","kind":"notebook-content","children":[{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":1,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"input_size=10","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"whb91D1jAQ"},{"type":"text","value":"：各入力要素の特徴の数（入力ベクトルの次元数）は10です","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"oPJJQA3YPZ"}],"key":"eDIG8ROfrD"}],"key":"dNPI825IZg"},{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"hidden_size=20","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"JKn1mugGvY"},{"type":"text","value":"：隠れ状態とセル状態の各ベクトルのサイズは20です","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"L5ST6yewYU"}],"key":"dEFtUz34yY"}],"key":"yPb9gn2Uz4"},{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"num_layers=2","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"dM13HzZC1k"},{"type":"text","value":"： LSTMの層の数は2です","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"U8ZGtj7c13"}],"key":"tOEO2oHvEe"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":4,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"最初のLSTM層は入力シーケンスを受け取り、それを処理して一連の隠れ状態を生成します。","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"JDSSuCsqPO"}],"key":"tP1p5VDBnJ"}],"key":"e4MFqxRyqr"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"最初の層の出力（隠れ状態）は、次のLSTM層の入力となります。これが複数層にわたって繰り返されます。","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"TDqzpeUGGx"}],"key":"Fh9lTHC0z1"}],"key":"EdXNYLA7do"}],"key":"NZbR1Od3gd"}],"key":"w6MF6Ebejz"}],"key":"YR4JzEW2Xz"}],"key":"JFKWVNTnIK"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import torch\nimport torch.nn as nn\n# LSTMのインスタンス化\nlstm = nn.LSTM(input_size=10, hidden_size=20,num_layers=2)","key":"wFDZiQ6svN"},{"type":"outputs","id":"pRGfmj5Z1lRXw1cdRu-FM","children":[],"key":"GrUehW7tuS"}],"key":"CzDTrlzWpL"},{"type":"block","kind":"notebook-content","children":[{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"入力データの生成（例：バッチサイズ=3, シーケンス長=5）","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Gl03wfvVB0"}],"key":"oqJYLB8tOl"}],"key":"dazdBihKKk"}],"key":"VIuNkLFDbQ"}],"key":"cl44m1tXH0"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"input = torch.randn(5, 3, 10)","key":"bdRNI6QbrZ"},{"type":"outputs","id":"Vj8FLkc32PtP9ollI93ET","children":[],"key":"o7C3ttSEcs"}],"key":"Z38AGfu25G"},{"type":"block","kind":"notebook-content","children":[{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":1,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":1,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"h0","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"L8GTWBcTEp"},{"type":"text","value":":隠れ状態の初期値","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"VIwJpTx3MS"}],"key":"JX4p7u9Qew"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"h0","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"bZXdtmzKgq"},{"type":"text","value":" のサイズは","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"BZKMxnK9n4"},{"type":"inlineCode","value":"(num_layers * num_directions, batch_size, hidden_size)","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"jkyNjUjJcu"},{"type":"text","value":"になります","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"pxHniXkMc0"}],"key":"L3Cm61xu3I"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"num_directions","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"icyl5XrSfC"},{"type":"text","value":":LSTMが単方向か双方向かを示し（単方向の場合は","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"mfljXMSAMD"},{"type":"text","value":"1","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"l6ILLXT6lo"},{"type":"text","value":"、双方向の場合は","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"l6Gn9C7Tt3"},{"type":"text","value":"2","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ayCvrhmZHC"},{"type":"text","value":"）","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"mgpzLBr9mA"}],"key":"MfarmTnYAy"}],"key":"hsGCItFMUB"}],"key":"JFcu4gM7q4"}],"key":"iS9pUFMxUN"}],"key":"V3Kl6E0sZc"}],"key":"KMhYJACo8K"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"c0","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"dq5HEyTsq4"},{"type":"text","value":":セル状態の初期値","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"q9YscJjJXb"}],"key":"FHw0e4nHsY"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"c0","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"fZvKLC95ek"},{"type":"text","value":" のサイズは同様に","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"v4fm0y6Hfk"},{"type":"inlineCode","value":"(num_layers * num_directions, batch_size, hidden_size)","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"I934Gr79ca"},{"type":"text","value":"になります","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"yOo5sJJIBm"}],"key":"EK6nywPy2f"}],"key":"BpvryfH062"}],"key":"DWOQ2GHHoO"}],"key":"OdwevumntR"}],"key":"qbuUaO0OuE"}],"key":"qhUfpbgL9H"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# 隠れ状態とセル状態の初期化\nh0 = torch.randn(2, 3, 20)\nc0 = torch.randn(2, 3, 20)","key":"hP5tJByzZ8"},{"type":"outputs","id":"B9Fv_RGq0O6RnWXmRi_QW","children":[],"key":"pYLY202Z3y"}],"key":"JDESSmDDi9"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"出力","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"vQDfqyaG1X"}],"identifier":"id","label":"出力","html_id":"id-1","implicit":true,"enumerator":"3","key":"c0WEKgURna"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"inlineCode","value":"torch.nn.LSTM","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"IIe2FNZ4SS"},{"type":"text","value":"の出力は、出力テンソル（通常は ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"K41A6sBgHL"},{"type":"inlineCode","value":"output","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"VZFK4OUj14"},{"type":"text","value":" と呼ばれます）と隠れ状態（","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Almh7hWdrx"},{"type":"inlineCode","value":"h_n","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"XGQo8gaJUZ"},{"type":"text","value":" と ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"L8DvGA7DHE"},{"type":"inlineCode","value":"c_n","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"t5WO9E4aKk"},{"type":"text","value":"）から構成されています","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"eik6ljIPbI"}],"key":"ixuTOgXNBi"}],"key":"bEQd9P4KaF"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# 順伝播\noutput, (hn, cn) = lstm(input, (h0, c0))","key":"JOZ2ROVEfg"},{"type":"outputs","id":"2OyUht4f8fJ188598BobU","children":[],"key":"dz4I15Onh7"}],"key":"zaqaFwOagq"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(f\"output: {output.shape}\")\nprint(f\"hn: {hn.shape}\")\nprint(f\"cn: {cn.shape}\")","key":"ySiA6O1GLB"},{"type":"outputs","id":"397M3cQQHH2No9CbqN1Pv","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"output: torch.Size([5, 3, 20])\nhn: torch.Size([2, 3, 20])\ncn: torch.Size([2, 3, 20])\n"},"children":[],"key":"XX3uuHPIut"}],"key":"PO3dCqPl9J"}],"key":"BQ3LZj4RI5"},{"type":"block","kind":"notebook-content","children":[{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":1,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":1,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"出力テンソル（","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"j8MYqmdHi8"},{"type":"inlineCode","value":"output","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"aJ9fAZkHjJ"},{"type":"text","value":"）","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"kN6Ke0ePp0"}],"key":"KbjeDxj89F"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"シーケンス内の各時点におけるLSTMの隠れ状態を含んでいます。","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"kFxJQaZXJC"}],"key":"FdGq7QNTVo"}],"key":"WZVjuBRILn"},{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"サイズは ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Nvxjy2vGOt"},{"type":"inlineCode","value":"(seq_len, batch, num_directions * hidden_size)","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"yoizeLh5uu"},{"type":"text","value":" になります。","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"GyUXjdPwlI"}],"key":"iqxWjRI04W"}],"key":"kt4hYc1vkz"}],"key":"Vm6yhPQlYX"}],"key":"Wu1ZafgvHA"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"最終隠れ状態(","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"kyxPf5R6W8"},{"type":"inlineCode","value":"h_n","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"ceChpIr1gm"},{"type":"text","value":")","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"WfOcN3nGMI"}],"key":"YkdtJJjoCW"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":5,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"LSTMの最終的な隠れ状態です。","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"ApeeBgqwbN"}],"key":"UIFRE1YA0O"}],"key":"caw1yoogNY"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"サイズは","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"rpeUTVCDs8"},{"type":"inlineCode","value":"(num_layers * num_directions, batch, hidden_size)","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"BLfHP0BaTp"},{"type":"text","value":" になります。","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"csBsRZfVx0"}],"key":"keTW6aYOtK"}],"key":"CsHqWye2k1"}],"key":"dU2sBj47YF"}],"key":"KaGS4citDE"}],"key":"WUVbR2ApxJ"},{"type":"admonition","kind":"note","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Note","key":"ZUaKtlCE2P"}],"key":"m5GoxZLJ0v"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":9,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"outputの最終時点の隠れ状態（つまり output[-1] ）は、単層、単方向LSTMの場合、hn と同じです。","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"TpBK1zhyIn"}],"key":"x5214GTwfp"}],"key":"bN4Oq9lYuE"},{"type":"listItem","spread":true,"position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"多層LSTMの場合、hnは各層の最終隠れ状態を含むため、outputの最終時点の隠れ状態とは異なることがあります。この場合、outputの最後の要素は最終層の最終隠れ状態に対応し、hn にはそれぞれの層の最終隠れ状態が格納されます。","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"oizvp0nVdi"}],"key":"sfvB7WqQGr"}],"key":"q9H0jTvzX4"}],"key":"mjGJkVEmHy"}],"key":"dbZBL3oVu8"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":13,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":13,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"最終セル状態(","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"SQOGUN6s7v"},{"type":"inlineCode","value":"c_n","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"SmdGhR6RGx"},{"type":"text","value":")","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"JTqlrIzttE"}],"key":"HKvsXKzmRT"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":14,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"LSTMの最終的なセル状態です。長期的な依存関係をどのように「記憶」しているかを示します。","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"gAsdfVwQDv"}],"key":"l8v5E3qF0u"}],"key":"mhANwBRk2G"},{"type":"listItem","spread":true,"position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"サイズは ","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"o89QFpSTUo"},{"type":"inlineCode","value":"(num_layers * num_directions, batch, hidden_size)","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"Nv2K4gn233"},{"type":"text","value":" です","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"vFi8nNg7AV"}],"key":"G5Ql1HvBbY"}],"key":"I7MnrTsy4E"}],"key":"R7lsQi7NOg"}],"key":"RcOl2fs1Af"}],"key":"LE2qreQtVd"}],"key":"HoDg98Xrrh"},{"type":"block","kind":"notebook-content","children":[{"type":"tabSet","children":[{"type":"tabItem","title":"質問1","children":[{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"タスクに応じて、torch.nn.LSTMの出力を扱う必要があります。例えば、テキスト生成、機械通訳、文書分類はそれぞれどの出力を使うべきですか？","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Nhe0K46bhk"}],"key":"ErZXdMxWY8"}],"key":"gKZToNGqFw"}],"key":"jOsQpzZby3"}],"key":"oMrjeFenfZ"}],"key":"nZLRERoJSy"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"LSTM","url":"/lstm","group":"RNN"},"next":{"title":"LSTMによる文書分類","url":"/lstm-classification","group":"RNN"}}},"domain":"http://localhost:3001"}