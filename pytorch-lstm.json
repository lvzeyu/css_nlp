{"version":3,"kind":"Notebook","sha256":"4fdca3aacd08163ecf128c84c75e48538c9d1e19558fcd5a31be4d27cd1f6d8f","slug":"pytorch-lstm","location":"/notebook/pytorch_lstm.ipynb","dependencies":[],"frontmatter":{"title":"LSTMの実装","content_includes_title":false,"kernelspec":{"name":"python3","display_name":"jupyterbook","language":"python"},"github":"https://github.com/lvzeyu/css_nlp","numbering":{"heading_1":{"enabled":true,"template":"enabled"},"heading_2":{"enabled":true,"template":"enabled"},"heading_3":{"enabled":true,"template":"enabled"},"heading_4":{"enabled":true,"template":"enabled"},"heading_5":{"enabled":true,"template":"enabled"},"heading_6":{"enabled":true,"template":"enabled"},"title":{"offset":1}},"source_url":"https://github.com/lvzeyu/css_nlp/blob/master/notebook/pytorch_lstm.ipynb","edit_url":"https://github.com/lvzeyu/css_nlp/edit/master/notebook/pytorch_lstm.ipynb","exports":[{"format":"ipynb","filename":"pytorch_lstm.ipynb","url":"/build/pytorch_lstm-b77a38b08d7f50d5822402223988501e.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"link","url":"https://pytorch.org/docs/stable/generated/torch.nn.LSTM.html","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"torch.nn.LSTM","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"jo0Zm9JBoi"}],"urlSource":"https://pytorch.org/docs/stable/generated/torch.nn.LSTM.html","key":"x3MhASiQnA"}],"identifier":"torch-nn-lstm","label":"torch.nn.LSTM","html_id":"torch-nn-lstm","implicit":true,"enumerator":"1","key":"O3Wkx5T9Bq"}],"key":"gyVBtQV1nz"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"PyTorchの","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"x1sMct0gsN"},{"type":"link","url":"https://pytorch.org/docs/stable/generated/torch.nn.LSTM.html","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"torch.nn.LSTM","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"o8RwA9YAId"}],"urlSource":"https://pytorch.org/docs/stable/generated/torch.nn.LSTM.html","key":"bsKHgnzyLV"},{"type":"text","value":"クラスを使用して、LSTMをモデルに簡単にレイヤーとして追加できます。","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"A6Thaqfmet"}],"key":"FfG5gSNyAq"}],"key":"jWahvsQmeU"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"inlineCode","value":"torch.nn.LSTM","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"YssUSKaX3g"},{"type":"text","value":"の主なパラメータは以下の通りです：","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"R7AwSNcrPb"}],"key":"DNtbr0OJv4"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":4,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"input_size","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"BIb6B6zQCL"},{"type":"text","value":"：入力xの特徴量の数","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"UUrbudtpmX"}],"key":"X4dqyM9r6I"}],"key":"iHCKnqBGsU"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"hidden_size","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"a7SC16PCbU"},{"type":"text","value":"：隠れ状態の特徴量の数","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"ID96hc1S7g"}],"key":"hrvLhwJXpY"}],"key":"UIK8LakFSB"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"num_layers","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"QJ4ZPl8bIO"},{"type":"text","value":"：LSTMを重ねる層の数（デフォルトは","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"BAXB0xx9qi"},{"type":"text","value":"1","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"PBqd9CbFq6"},{"type":"text","value":"）","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"wIv3T25sJu"}],"key":"U1rMGrkL0p"}],"key":"G4wDlqb8rf"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"bias","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"IyJAt6ELmv"},{"type":"text","value":"：バイアスを使用するかどうか（デフォルトは","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"GRHzr0fgyc"},{"type":"inlineCode","value":"True","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"CoPntWW8J8"},{"type":"text","value":"）","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"t1vdesMokn"}],"key":"Hip0EPMBfh"}],"key":"Ghescz6Lvw"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"batch_first","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"bks4LOHLf0"},{"type":"text","value":"：入力と出力のテンソルの形状が(","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"QWQJvIETxY"},{"type":"inlineCode","value":"batch","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"NIZXMGDFrh"},{"type":"text","value":", ","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"cXmTdgGKaf"},{"type":"inlineCode","value":"seq","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"xm5JXj9j9A"},{"type":"text","value":", ","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"cdzW11FE3d"},{"type":"inlineCode","value":"feature","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"Y5iADiAc0u"},{"type":"text","value":")になるようにするかどうか（デフォルトは","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"TU6VcUXHU7"},{"type":"inlineCode","value":"False","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"xvp9lcS43r"},{"type":"text","value":"）","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"OzAntmnUlR"}],"key":"iR4PrhBCoe"}],"key":"whorA5snit"},{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"dropout","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"UYwqlD0MGj"},{"type":"text","value":"：ドロップアウトを適用する確率（デフォルトは","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"lxcTvN4IBx"},{"type":"text","value":"0","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"zmYUb2bPsX"},{"type":"text","value":"、つまりドロップアウトなし）","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"hWvpcNPlkz"}],"key":"CUan2JgNH8"}],"key":"WvZyEGrQXF"},{"type":"listItem","spread":true,"position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"bidirectional","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"vjTByXsNMY"},{"type":"text","value":"：双方向LSTMを使用するかどうか（デフォルトは","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"pg9X8kRkPX"},{"type":"inlineCode","value":"False","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"xKJyuZm08r"},{"type":"text","value":"）","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"KJycgi620J"}],"key":"CsDJ9JmLwh"}],"key":"KXErZj2pbJ"}],"key":"gZwKnztSlj"}],"key":"kuY2T2xe5k"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"入力","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"esVi8UbhaP"}],"identifier":"id","label":"入力","html_id":"id","implicit":true,"enumerator":"2","key":"Rm7AOqRfK3"}],"key":"BjGpfjZzrg"},{"type":"block","kind":"notebook-content","children":[{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":1,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"input_size=10","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"QfNjs6C3TU"},{"type":"text","value":"：各入力要素の特徴の数（入力ベクトルの次元数）は10です","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"hAdqigp731"}],"key":"ygGR2dCJjc"}],"key":"vv358DGPlf"},{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"hidden_size=20","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"exDIR1a4aS"},{"type":"text","value":"：隠れ状態とセル状態の各ベクトルのサイズは20です","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"aBJB9FohSs"}],"key":"dmXGTsm1Xz"}],"key":"DJhGZ79OkV"},{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"num_layers=2","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ibpPKbRdTO"},{"type":"text","value":"： LSTMの層の数は2です","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"jTV4tBOFzw"}],"key":"gzMsva7sFI"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":4,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"最初のLSTM層は入力シーケンスを受け取り、それを処理して一連の隠れ状態を生成します。","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"PQ7cyFTp8W"}],"key":"TasXsKIljo"}],"key":"LkUP2tRpBZ"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"最初の層の出力（隠れ状態）は、次のLSTM層の入力となります。これが複数層にわたって繰り返されます。","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"SoWY6GMkKa"}],"key":"BB1ofBZZCw"}],"key":"oTg6DwfAG3"}],"key":"wUbRjZEMH5"}],"key":"boV6aSxy3U"}],"key":"AC0fZyZ1Jp"}],"key":"XQo9kxLCHG"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import torch\nimport torch.nn as nn\n# LSTMのインスタンス化\nlstm = nn.LSTM(input_size=10, hidden_size=20,num_layers=2)","key":"lANp0mNY7W"},{"type":"outputs","id":"3eJKWbxQzGPrJXFJjdqDK","children":[],"key":"BYU2yiZZO5"}],"key":"mIyDHsSD5F"},{"type":"block","kind":"notebook-content","children":[{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"入力データの生成（例：バッチサイズ=3, シーケンス長=5）","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"HZcn1JPIZ4"}],"key":"e4mPbrmN2R"}],"key":"orjfkSifS7"}],"key":"ODj5qgt25a"}],"key":"LqtktHsOsk"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"input = torch.randn(5, 3, 10)","key":"vK1cPEBjvX"},{"type":"outputs","id":"qN40foyXqEnKrmA4LeBJi","children":[],"key":"hLGsMMXGNh"}],"key":"xkd53eCHSJ"},{"type":"block","kind":"notebook-content","children":[{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":1,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":1,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"h0","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"x3xlscewxO"},{"type":"text","value":":隠れ状態の初期値","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"hWAxViq6EJ"}],"key":"Ugqad2FYA0"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"h0","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"qctujNhQrQ"},{"type":"text","value":" のサイズは","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"ohEg9JPxbR"},{"type":"inlineCode","value":"(num_layers * num_directions, batch_size, hidden_size)","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"hCG0ZIBHnh"},{"type":"text","value":"になります","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"aKLxTK5rwY"}],"key":"dsVb5YlblR"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"num_directions","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"CpOnWY8M7m"},{"type":"text","value":":LSTMが単方向か双方向かを示し（単方向の場合は","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"QfbZcjgRLM"},{"type":"text","value":"1","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"SzS18uFplq"},{"type":"text","value":"、双方向の場合は","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Le5dAiNlUn"},{"type":"text","value":"2","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"XGXLjlg05a"},{"type":"text","value":"）","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"xdJVUFAGRq"}],"key":"kNAbJ1eAz6"}],"key":"ETxxxUmixw"}],"key":"HtkfaeuJeQ"}],"key":"T9DKAK7FiC"}],"key":"qCyfsX9bQe"}],"key":"M159s5ycpu"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"c0","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"k3wJAcXrxS"},{"type":"text","value":":セル状態の初期値","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"WlMJEsgMz7"}],"key":"XTmUpunpXS"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"c0","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"yFuv7doNox"},{"type":"text","value":" のサイズは同様に","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"SzaanDv6ng"},{"type":"inlineCode","value":"(num_layers * num_directions, batch_size, hidden_size)","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"ah48V91Sm5"},{"type":"text","value":"になります","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"QZlmFqKJmS"}],"key":"Frt8IRDNz3"}],"key":"o2EVu0HMJg"}],"key":"iM8R1sy715"}],"key":"FzkryAzalh"}],"key":"UFzHhFEsEu"}],"key":"gecGLsduE9"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# 隠れ状態とセル状態の初期化\nh0 = torch.randn(2, 3, 20)\nc0 = torch.randn(2, 3, 20)","key":"DVjdzBUcHd"},{"type":"outputs","id":"--mWA20SZVzYCK32VTzhV","children":[],"key":"nY3umN6xoF"}],"key":"c8AmKVFk6L"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"出力","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ic69mCll2Z"}],"identifier":"id","label":"出力","html_id":"id-1","implicit":true,"enumerator":"3","key":"OLm7q5MZ3g"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"inlineCode","value":"torch.nn.LSTM","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"hjKBbt05VD"},{"type":"text","value":"の出力は、出力テンソル（通常は ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"X25HkIDGgf"},{"type":"inlineCode","value":"output","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"lGCjknydHv"},{"type":"text","value":" と呼ばれます）と隠れ状態（","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"x55amTT2fN"},{"type":"inlineCode","value":"h_n","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"IteIC5P9Z7"},{"type":"text","value":" と ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"KURRwpBVvk"},{"type":"inlineCode","value":"c_n","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"KWkcfmPrjX"},{"type":"text","value":"）から構成されています","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"fasRa7c07T"}],"key":"AFNhMlnlC8"}],"key":"ikPCeS2MLx"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# 順伝播\noutput, (hn, cn) = lstm(input, (h0, c0))","key":"jDOYohaDWc"},{"type":"outputs","id":"-1_qqRI7RYFspSG68dFIG","children":[],"key":"yms5oEfURi"}],"key":"PwhCwJu6Qw"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(f\"output: {output.shape}\")\nprint(f\"hn: {hn.shape}\")\nprint(f\"cn: {cn.shape}\")","key":"rRNomo3rBW"},{"type":"outputs","id":"f6vQ7m_uaiHUtGUSX7K91","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"output: torch.Size([5, 3, 20])\nhn: torch.Size([2, 3, 20])\ncn: torch.Size([2, 3, 20])\n"},"children":[],"key":"qS86d8yhTJ"}],"key":"acF7SIb6EL"}],"key":"KmUtpXKTJW"},{"type":"block","kind":"notebook-content","children":[{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":1,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":1,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"出力テンソル（","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"diwDEYn3Zk"},{"type":"inlineCode","value":"output","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"FdzxBWMQoE"},{"type":"text","value":"）","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"sSDaQ3hNSt"}],"key":"NDb0vbXGsI"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"シーケンス内の各時点におけるLSTMの隠れ状態を含んでいます。","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"CoBuWjNGfF"}],"key":"GiyX6W7dRK"}],"key":"gigfTI0SIp"},{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"サイズは ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"oO2f6uoibr"},{"type":"inlineCode","value":"(seq_len, batch, num_directions * hidden_size)","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"wNaNELCHwx"},{"type":"text","value":" になります。","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Ytt7YzbkLO"}],"key":"vBLJnW5eqB"}],"key":"CNkS3SZAkD"}],"key":"eSkh9xLDDc"}],"key":"kPfLDD1DmV"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"最終隠れ状態(","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"HvIHnfQlgU"},{"type":"inlineCode","value":"h_n","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"XWmhBrDEW6"},{"type":"text","value":")","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"m4z9FKjKps"}],"key":"XKtKpdVYOL"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":5,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"LSTMの最終的な隠れ状態です。","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"it6czPOI3x"}],"key":"k0yGDTuAiW"}],"key":"FTrj23XFS6"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"サイズは","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"vYSRi0iEqD"},{"type":"inlineCode","value":"(num_layers * num_directions, batch, hidden_size)","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"jE6hQX6Zp1"},{"type":"text","value":" になります。","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"dsFdebqRwn"}],"key":"yA2azU6q5D"}],"key":"M6F668AR0o"}],"key":"JMfzR5HzBH"}],"key":"uALnwLawBw"}],"key":"oBlDLiKMx6"},{"type":"admonition","kind":"note","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Note","key":"k6Fdexq6fw"}],"key":"x6ec0dbPqI"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":9,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"outputの最終時点の隠れ状態（つまり output[-1] ）は、単層、単方向LSTMの場合、hn と同じです。","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"PUGrmHL6ZR"}],"key":"YjcFoKqbmV"}],"key":"KOa4LayvTM"},{"type":"listItem","spread":true,"position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"多層LSTMの場合、hnは各層の最終隠れ状態を含むため、outputの最終時点の隠れ状態とは異なることがあります。この場合、outputの最後の要素は最終層の最終隠れ状態に対応し、hn にはそれぞれの層の最終隠れ状態が格納されます。","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"aDRfFRSkL0"}],"key":"EBdDYBCZ87"}],"key":"mzfov7gyeC"}],"key":"FZ9Ve4inbr"}],"key":"ANxaUFOmzZ"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":13,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":13,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"最終セル状態(","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"bwIiIoKHf8"},{"type":"inlineCode","value":"c_n","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"wzLWNtagiJ"},{"type":"text","value":")","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"l6BfOpcVs9"}],"key":"psOfntC7ww"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":14,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"LSTMの最終的なセル状態です。長期的な依存関係をどのように「記憶」しているかを示します。","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"P0CJ73kwiQ"}],"key":"rgHkTBjarY"}],"key":"xwKcTsdhql"},{"type":"listItem","spread":true,"position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"サイズは ","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"hHUY3B2DL4"},{"type":"inlineCode","value":"(num_layers * num_directions, batch, hidden_size)","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"erwsRAwM5g"},{"type":"text","value":" です","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"ewptOCBVju"}],"key":"lYNPytnGsa"}],"key":"Kf2vcAcIkh"}],"key":"ntJlXcbfiw"}],"key":"znoZ5dHn3C"}],"key":"juKIF9rS97"}],"key":"rJJkCgfBlM"},{"type":"block","kind":"notebook-content","children":[{"type":"tabSet","children":[{"type":"tabItem","title":"質問1","children":[{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"タスクに応じて、torch.nn.LSTMの出力を扱う必要があります。例えば、テキスト生成、機械通訳、文書分類はそれぞれどの出力を使うべきですか？","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"qd81tAA7XR"}],"key":"fvt25zwy2t"}],"key":"akZIwVcCUa"}],"key":"kg8SGEx7qd"}],"key":"ky5zHbBs2H"}],"key":"mbVKETq5wp"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"LSTM","url":"/lstm","group":"RNN"},"next":{"title":"LSTMによる文書分類","url":"/lstm-classification","group":"RNN"}}},"domain":"http://localhost:3000"}