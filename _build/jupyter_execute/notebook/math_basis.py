#!/usr/bin/env python
# coding: utf-8

# # æ•°å­¦åŸºç¤
# 
# æœ¬è¬›ç¾©ã¯ã€æ·±å±¤å­¦ç¿’(ä¸»ã«ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯)ã«ã¤ã„ã¦è§£èª¬ã—ã¾ã™ã€‚ã“ã“ã§ã¯ã€ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã®ç†è§£ã«å¿…è¦ãªæ•°å­¦ã®åŸºæœ¬çŸ¥è­˜ã‚’ãŠã•ã‚‰ã„ã—ã¾ã™ã€‚

# ## å¾®åˆ†
# 
# ### å¾®åˆ†ã®æ¦‚å¿µ
# 
# å¾®åˆ†ã¨ã¯ã€çµè«–ã‹ã‚‰è¨€ã†ã¨ã€å¤‰æ•°ã®å¾®å°ãªå¤‰åŒ–ã«å¯¾å¿œã™ã‚‹ã€é–¢æ•°ã®å¤‰åŒ–é‡ã‚’æ±‚ã‚ã‚‹ã“ã¨ã§ã™ã€‚
# 
# å¾®åˆ†ã‚’ç”¨ã„ã‚‹ã¨æ¥ç·šã®å‚¾ãã‚’è¨ˆç®—ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ã“ã®ã“ã¨ã‹ã‚‰ã€å¾®åˆ†ãŒé–¢æ•°ã®æœ€å°åŒ–å•é¡Œã«æœ‰ç”¨ãªãƒ„ãƒ¼ãƒ«ã§ã‚ã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚
# 
# - $x$ã‹ã‚‰$â„$ã ã‘é›¢ã‚ŒãŸç‚¹$ğ‘¥+â„$ã‚’è€ƒãˆ, 2ç‚¹ã‚’é€šã‚‹ç›´ç·šã®å‚¾ãã‚’æ±‚ã‚ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
# 
# $$
# a= \frac{f(x + h) - f(x)}{(x+h)-x}
# $$
# 
# - æ¬¡ã«$h$ã‚’$h \rightarrow 0$ã®ã‚ˆã†ã«å°ã•ãã—ã¦ã„ã‘ã°ã€ç›´ç·šã®é–‹å§‹ç‚¹ã¨çµ‚äº†ç‚¹ã®2ç‚¹ãŒ1ç‚¹ã«åæŸã—ã€1ç‚¹ã§ã®æ¥ç·šã¨ã—ã¦è€ƒãˆã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ã“ã®ã‚ˆã†ã«ã€å¹³å‡å¤‰åŒ–ç‡ã®æ¥µé™å€¤ãŒå­˜åœ¨ã™ã‚‹ãªã‚‰ã°ã€å¾®åˆ†å¯èƒ½ã§ã‚ã‚‹ã¨è¨€ã„ã¾ã™ã€‚ã“ã®å¼ã‚’$f$ã®å°é–¢æ•° (derivative)ã¨å‘¼ã³ã€$f'(x)$ã¨æ›¸ãã¾ã™ã€‚é–¢æ•°$f(x)$ã®å¾®åˆ†ä¿‚æ•°$f'(a)$ã¯ãã®æ›²ç·šã®ç‚¹$(a,f(a))$(æ¥ç‚¹)ã«ãŠã‘ã‚‹æ¥ç·šã®å‚¾ãã§ã™ã€‚
# 
# $$
# f'(x)= \lim_{h \rightarrow 0} \frac{f(x + h) - f(x)}{h}
# $$
# ![](./Figure/derivative.png)
# 
# - å°é–¢æ•°ã‚’æ±‚ã‚ã‚‹ã“ã¨ã‚’å¾®åˆ†(differentiation)ã™ã‚‹ã¨ã„ã„ã¾ã™ã€‚ è¨˜å·ã®ä½¿ã„æ–¹ã¨ã—ã¦ã€$f'(x)$ã‚’$\frac{df}{dx} (x)$ ã¾ãŸã¯ $ \frac{d}{dx}f (x)$ã¨æ›¸ãã¾ã™ã€‚

# ```{margin}
# 
# é–¢æ•° $f(x)$ ã«ã¤ã„ã¦ã€å¤‰æ•° $x$ã‚’ã‚ã‚‹å€¤ $a$ ã«é™ã‚Šãªãè¿‘ã¥ã‘ã‚‹ã¨ãã€ã©ã®ã‚ˆã†ãªè¿‘ã¥ã‘æ–¹ã«å¯¾ã—ã¦ã‚‚é–¢æ•° $f(x)$ã€€ã®å€¤ãŒä¸€å®šå€¤$A$ã«é™ã‚Šãªãè¿‘ã¥ããªã‚‰ã°ã€$x$ãŒ$a$ã«è¿‘ã¥ãã¨ã$f(x)$ã¯å€¤$A$ã«åæŸã¨ã„ã„ã€$A$ã‚’æ¥µé™å€¤ã¨è¨€ã„ã¾ã™ã€‚
# 
# ```

# ### Pythonã«ã‚ˆã‚‹å¾®åˆ†è¨ˆç®—

# Pythonã§å¾®åˆ†ã‚’è¨ˆç®—ã™ã‚‹ãŸã‚ã«ã¯ã€```SymPy```ã¨ã„ã†ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ç”¨ã™ã‚‹ã®ãŒä¸€èˆ¬çš„ã§ã™ã€‚

# In[1]:


from sympy import symbols, diff

# ã‚·ãƒ³ãƒœãƒªãƒƒã‚¯å¤‰æ•°ã®å®šç¾©
x = symbols('x')

# é–¢æ•°ã®å®šç¾©
function_1 = x**3 - 3*x**2 + x

# é–¢æ•°ã®å¾®åˆ†
function_1_prime = diff(function_1, x)

function_1_prime


# In[2]:


# x=4ã‚’ä»£å…¥ã—ã¦å€¤ã‚’è¨ˆç®—
value_at_x4 = function_1_prime.subs(x, 4)

print(value_at_x4)


# In[3]:


# å¾®åˆ†ã®è¿‘ä¼¼è¨ˆç®—ã®ç²¾åº¦ã¨è¨ˆç®—ã®å®‰å®šæ€§ã®ãƒãƒ©ãƒ³ã‚¹ã‚’ã¨ã‚‹ãŸã‚ã«ã€ä¸­å¿ƒå·®åˆ†æ³•ã¨ã„ã£ãŸé–¢æ•°ã®å‰å¾Œã®ç‚¹ã‚’ä½¿ç”¨ã—ã¦è¨ˆç®—ã™ã‚‹æ–¹æ³•ã‚’ç”¨ã„ã‚‹
def numerical_diff(f,x):
    h = 1e-4 # å¾®å°ãªå¤‰åŒ–é‡: 0.0001
    nd = (f(x+h) - f(x-h))/(2 * h)
    return nd


# In[4]:


def function_1(x):
    return x**3 - 3*x**2 + x


# In[5]:


print(numerical_diff(function_1, 4)) # 25.0 ã«è¿‘ã„å€¤ãŒæœŸå¾…ã•ã‚Œã‚‹


# ### å¾®åˆ†ã®å…¬å¼
# 
# è¦šãˆã¦ãŠãã¨ä¾¿åˆ©ãªå¾®åˆ†ã®å…¬å¼ãŒã‚ã‚Šã¾ã™ã®ã§ï¼Œä»¥ä¸‹ã«å¹¾ã¤ã‹ç´¹ä»‹ã—ã¦ã„ãã¾ã™ã€‚
# 
# $$
# \begin{split}\begin{align}
# \left( c\right) ^{'}&=0 \\
# \left( x\right)^{'}&=1\\
# \left( cf(x) \right)^{'} &= c f'(x) \\
# \left( x^{n} \right)^{'} &=nx^{n-1} \\
# \left( f(x) + g(x) \right) ^{'} &=f^{'}(x)+g^{'}(x) \\
# \left( f(x) g(x) \right) ^{'} &= f^{'}(x)g(x) + f(x)g^{'}(x) \\
# \left( f(g(x)) \right) ^{'} &= \frac{df(u)}{du}\frac{du}{dx} = f^{'}(g(x)) \cdot g^{'}(x) \\
# \end{align}\end{split}
# 
# $$

# ### åˆæˆé–¢æ•°ã®å¾®åˆ†
# 
# $ğ‘¦=ğ‘“(ğ‘¥)$ã¨ $ğ‘§=ğ‘”(ğ‘¦)$ã®åˆæˆé–¢æ•°ã¨ã¯ã€$ğ‘“$ã‚’é©ç”¨ã—ãŸã‚ã¨ã«$ğ‘”$ã‚’é©ç”¨ã™ã‚‹é–¢æ•°ã€ã™ãªã‚ã¡ $ğ‘§=ğ‘”(ğ‘“(ğ‘¥))$ã®ã“ã¨ã‚’æŒ‡ã—ã¾ã™ã€‚
# 
# **<u>åˆæˆé–¢æ•°ã®å°é–¢æ•°ãŒãã‚Œãã‚Œã®å°é–¢æ•°ã®ç©ã§ä¸ãˆã‚‰ã‚Œã‚‹æ€§è³ªã¯é€£é–å¾‹ï¼ˆchain ruleï¼‰ã¨è¨€ã„ã¾ã™ã€‚**</u>
# 
# $$
# \frac{d}{dx} f(g(x)) = \frac{df(u)}{du}\frac{du}{dx}
# $$

# ```{note}
# 
# é–¢æ•°
# $y = \sin(3x^2 + 4x)$
# ã®å¾®åˆ†ã‚’æ±‚ã‚ã¾ã™ã€‚
# 
# ã“ã“ã§ã€
# 
# $$f(u) = \sin(u)$$
# 
# $$g(x) = 3x^2 + 4x$$
# ã¨ã—ã€$y$ ã¯ $f$ ã¨ $g$ ã®åˆæˆé–¢æ•°ã€ã™ãªã‚ã¡ $y = f(g(x))$ ã§ã‚ã‚‹ã¨è€ƒãˆã¾ã™ã€‚
# 
# é€£é–å¾‹ã‚’ç”¨ã„ã‚‹ã¨:
# 
# $$
# \frac{dy}{dx} = \frac{df}{du} \cdot \frac{du}{dx}
# $$
# 
# 1. $f'(u) = \cos(u)$
# 2. $g'(x) = 6x + 4$
# 
# ã“ã‚Œã‚‰ã‚’é€£é–å¾‹ã®å¼ã«ä»£å…¥ã™ã‚‹ã¨:
# 
# $$
# frac{dy}{dx} = \cos(3x^2 + 4x) \cdot (6x + 4)
# $$
# 
# ã—ãŸãŒã£ã¦ã€
# 
# $$
# y' =  \cos(3x^2 + 4x) \cdot (6x + 4)
# $$
# 
# ãŒå¾—ã‚‰ã‚Œã¾ã™ã€‚
# 
# ã“ã®ã‚ˆã†ã«ã€é€£é–å¾‹ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã§ã€åˆæˆé–¢æ•°ã®å¾®åˆ†ã‚’è¨ˆç®—ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
# 
# ```

# ### åå¾®åˆ†
# 
# æ©Ÿæ¢°å­¦ç¿’ã«ãŠã„ã¦ã€å¤šãã®å ´åˆã€è¤‡æ•°ã®å…¥åŠ›å¤‰æ•° $ğ‘¥_1,ğ‘¥_2,â€¦,ğ‘¥_n$ã‚’ç”¨ã„ã¦$ğ‘¦$ã‚’äºˆæ¸¬ã™ã‚‹å¤šå¤‰æ•°é–¢æ•°ãŒæ‰±ã‚ã‚Œã¾ã™ã€‚
# 
# **<u>åå¾®åˆ†**</u>ã¨ã¯ã€$n$å¤‰æ•°é–¢æ•°ã®ã‚ã‚‹ä¸€ã¤ã®å¤‰æ•°ä»¥å¤–ã®$n-1$å€‹ã®å¤‰æ•°ã®å€¤ã‚’å›ºå®šã—ã€æ®‹ã‚Šã®$1$ã¤ã®å¤‰æ•°ã«ã¤ã„ã¦é–¢æ•°ã‚’å¾®åˆ†ã™ã‚‹ã“ã¨ã§ã™ã€‚
# 
# ä¾‹ãˆã°ã€ã‚ã‚‹å…¥åŠ› $ğ‘¥_n$ã«ã®ã¿æ³¨ç›®ã™ã‚‹åå¾®åˆ†ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«è¡¨ã—ã¾ã™ã€‚
# 
# $$
# \frac{\partial}{\partial x_{n}} f(x_1, x_2, \dots, x_n)
# $$
# 
# å¾®åˆ†ã‚’æ„å‘³ã™ã‚‹è¨˜å·ãŒã€$ğ‘‘$ã‹ã‚‰$\partial$ã«å¤‰ã‚ã£ã¦ã„ã¾ã™ã€‚ã“ã†ã™ã‚‹ã¨ã€$\frac{\partial}{\partial x_{n}}$ã¯ $x_n$ä»¥å¤–ã‚’å®šæ•°ã¨è€ƒãˆã€ $x_n$ã«ã®ã¿ç€ç›®ã—ã¦å¾®åˆ†ã‚’è¡Œã†ã¨ã„ã†æ„å‘³ã¨ãªã‚Šã¾ã™ã€‚
# 
# ```{note}
# $$
# \begin{split}\begin{aligned}
# \frac{\partial}{\partial x_1}
# \left( 3x_1+4x_2 \right)
# &= \frac{\partial}{\partial x_1}
# \left( 3x_1 \right) + \frac{\partial}{\partial x_1} \left( 4x_2 \right) \\
# &= 3 \times \frac{\partial}{\partial x_1} \left( x_1 \right) + 4 \times \frac{\partial}{\partial x_1} x_2 \\
# &= 3 \times 1 + 4 \times 0 \\
# &= 3
# \end{aligned}\end{split}
# $$
# ```

# In[6]:


import numpy as np
import matplotlib.pyplot as plt
from sympy import symbols, diff
plt.style.use('seaborn-paper') 

x, y = symbols('x y')

# é–¢æ•°ã®å®šç¾©
f = x**2 + y**2

# åå¾®åˆ†ã®è¨ˆç®—
partial_x = diff(f, x)
partial_y = diff(f, y)

print("Partial Derivative with respect to x:", partial_x)
print("Partial Derivative with respect to y:", partial_y)


# In[7]:


# å¯è¦–åŒ–ã®ãŸã‚ã®ãƒ‡ãƒ¼ã‚¿ç”Ÿæˆ
X, Y = np.meshgrid(np.linspace(-5, 5, 100), np.linspace(-5, 5, 100))
Z = X**2 + Y**2
Zx = 2*X
Zy = 2*Y

fig = plt.figure(figsize=(20, 6))

# Original Function
ax1 = fig.add_subplot(1, 3, 1, projection='3d')
ax1.plot_surface(X, Y, Z, cmap='jet')
ax1.set_title("Function: f(x,y) = x^2 + y^2")
ax1.set_xlabel('x')
ax1.set_ylabel('y')
ax1.set_zlabel('f(x, y)')

# Partial Derivative with respect to x
ax2 = fig.add_subplot(1, 3, 2, projection='3d')
ax2.plot_surface(X, Y, Zx, cmap='jet')
ax2.set_title("Partial Derivative: df/dx")
ax2.set_xlabel('x')
ax2.set_ylabel('y')
ax2.set_zlabel('df/dx')

# Partial Derivative with respect to y
ax3 = fig.add_subplot(1, 3, 3, projection='3d')
ax3.plot_surface(X, Y, Zy, cmap='jet')
ax3.set_title("Partial Derivative: df/dy")
ax3.set_xlabel('x')
ax3.set_ylabel('y')
ax3.set_zlabel('df/dy')

plt.tight_layout()
plt.show()


# ## ç·šå‹ä»£æ•°
# 
# ### ãƒ™ã‚¯ãƒˆãƒ«
# 
# #### ãƒ™ã‚¯ãƒˆãƒ«ã¨ã¯
# 
# 
# ãƒ™ã‚¯ãƒˆãƒ«(vector)ã¨ã¯ã€å¤§ãã•ã¨å‘ãã‚’æŒã¤é‡ã§ã™ã€‚ãƒ™ã‚¯ãƒˆãƒ«ã¯ã€æ•°ãŒä¸€åˆ—ã«ä¸¦ã‚“ã é›†ã¾ã‚Šã¨ã—ã¦è¡¨ç¾ã§ãã¾ã™ã€‚ä¾‹ãˆã°ã€
# 
# $$
# \begin{split}{\bf x}= \begin{bmatrix}
# x_{1} \\
# x_{2} \\
# x_{3}
# \end{bmatrix}, \
# {\bf y}=\begin{bmatrix}
# y_{1} \\
# y_{2} \\
# \vdots \\
# y_{N}
# \end{bmatrix}\end{split}
# $$
# ä¸Šã®ä¾‹ã®ã‚ˆã†ã«ã€ãã®è¦ç´ ã‚’ç¸¦æ–¹å‘ã«ä¸¦ã¹ãŸã‚‚ã®ã¯åˆ—ãƒ™ã‚¯ãƒˆãƒ«ã¨å‘¼ã³ã¾ã™ã€‚ä¸€æ–¹ã€
# 
# $$
# {\bf z}=\begin{bmatrix}
# z_{1} & z_{2} & z_{3}
# \end{bmatrix}
# $$
# 
# ã®ã‚ˆã†ã«ã€è¦ç´ ã‚’æ¨ªæ–¹å‘ã«ä¸¦ã¹ãŸã‚‚ã®ã¯è¡Œãƒ™ã‚¯ãƒˆãƒ«ã¨å‘¼ã³ã¾ã™ã€‚
# 
# ä¸€èˆ¬çš„ã«ã¯ã€ãƒ™ã‚¯ãƒˆãƒ«ã‚’æ•°å¼ã§æ›¸ãéš›ã«ã¯, $\mathbf{W}$ã®ã‚ˆã†ã«å¤ªå­—ã®è¨˜å·ã§è¡¨ç¾ã™ã‚‹ã‹ã€$\vec{W}$ã®ã‚ˆã†ã«ãƒ™ã‚¯ãƒˆãƒ«ã®ä¸Šã«çŸ¢å°ã‚’ä»˜ã‘ã¦ãƒ™ã‚¯ãƒˆãƒ«ã‚’ç¤ºã™ã“ã¨ãŒå¤šã„ã§ã™ã€‚
# 
# #### ãƒ™ã‚¯ãƒˆãƒ«ã®æ•°å­¦æ¼”ç®—
# 
# - åŠ ç®—ï¼ˆè¶³ã—ç®—ï¼‰åŠã³æ¸›ç®—ï¼ˆå¼•ãç®—ï¼‰ã¯åŒã˜ã‚µã‚¤ã‚ºã®ãƒ™ã‚¯ãƒˆãƒ«åŒå£«ã®é–“ã ã‘ã§æˆç«‹ã—ã¾ã™ã€‚
# 
# $$
# \begin{split}\begin{bmatrix}
# 1 \\
# 2 \\
# 3
# \end{bmatrix}+\begin{bmatrix}
# 4 \\
# 5 \\
# 6
# \end{bmatrix}=\begin{bmatrix}
# 1 + 4 \\
# 2 + 5 \\
# 3 + 6
# \end{bmatrix}=\begin{bmatrix}
# 5 \\
# 7 \\
# 9
# \end{bmatrix}\end{split}
# $$

# - ã‚¹ã‚«ãƒ©å€ã¨ã¯ãƒ™ã‚¯ãƒˆãƒ«ã«ã‚¹ã‚«ãƒ©ã‚’æ›ã‘ã‚‹æ¼”ç®—ã§ã™ã€‚
# 
# $$
# \begin{split}
# 10
# \begin{bmatrix}
# 1 \\
# 2 \\
# 3
# \end{bmatrix}=\begin{bmatrix}
# 10 * 1 \\
# 10 * 2 \\
# 10 * 3
# \end{bmatrix}=\begin{bmatrix}
# 10 \\
# 20 \\
# 30
# \end{bmatrix}\end{split}
# $$
# 

# - å†…ç© (inner product) ã¨ã¯ã€åŒã˜ã‚µã‚¤ã‚ºã®2ã¤ã®ãƒ™ã‚¯ãƒˆãƒ«ã¯ã€ãã‚Œãã‚Œã®ãƒ™ã‚¯ãƒˆãƒ«ã®åŒã˜ä½ç½®ã«å¯¾å¿œã™ã‚‹è¦ç´ åŒå£«ã‚’æ›ã‘ã€ãã‚Œã‚‰ã‚’è¶³ã—åˆã‚ã›ã‚‹è¨ˆç®—ã§ã™ã€‚$ğ±$ã¨$ğ²$ã®å†…ç©ã¯$ğ±\cdotğ²$ã§è¡¨ã•ã‚Œã¾ã™ã€‚
# 
# $$
# \begin{split}\begin{aligned}& \begin{bmatrix}
# 1 & 2 & 3
# \end{bmatrix} \cdot \begin{bmatrix}
# 4 \\
# 5 \\
# 6
#  \end{bmatrix} = 1 \times 4 + 2 \times 5  + 3 \times 6 = 32 \end{aligned}\end{split}
# 
# $$

# ### è¡Œåˆ—
# 
# #### è¡Œåˆ—ã¨ã¯
# 
# è¡Œåˆ— (matrix) ã¯åŒã˜ã‚µã‚¤ã‚ºã®ãƒ™ã‚¯ãƒˆãƒ«ã‚’è¤‡æ•°å€‹ä¸¦ã¹ãŸã‚‚ã®ã§ã™ã€‚è¡Œåˆ— (matrix) ã¯åŒã˜ã‚µã‚¤ã‚ºã®ãƒ™ã‚¯ãƒˆãƒ«ã‚’è¤‡æ•°å€‹ä¸¦ã¹ãŸã‚‚ã®ã§ã™ã€‚ä¾‹ãˆã°ã€
# 
# $$
# \begin{split}
# {\bf X} =
# \begin{bmatrix}
# x_{11} & x_{12} \\
# x_{21} & x_{22} \\
# x_{31} & x_{32}
# \end{bmatrix}
# \end{split}
# $$
# 
# $\mathbf{X}$ã¯ã€Œ 3 è¡Œ 2 åˆ—ã®è¡Œåˆ—ã€ã«ãªã‚Šã¾ã™ã€‚
# 
# #### è¡Œåˆ—ç©
# 
# è¡Œåˆ—ã®ä¹—ç®—ã«ã¯ã€è¡Œåˆ—ç©ã€å¤–ç©ã€è¦ç´ ç©ï¼ˆã‚¢ãƒ€ãƒãƒ¼ãƒ«ç©ï¼‰ãªã©è¤‡æ•°ã®æ–¹æ³•ãŒã‚ã‚Šã¾ã™ã€‚ ã“ã“ã§ã¯ãã®ã†ã¡ã€æ©Ÿæ¢°å­¦ç¿’ã®å¤šãã®å•é¡Œã§ç™»å ´ã—ã¾ã™è¡Œåˆ—ç©ã«ã¤ã„ã¦èª¬æ˜ã—ã¾ã™ã€‚
# 
# è¡Œåˆ—$\mathbf{A}$ã¨è¡Œåˆ—$\mathbf{B}$ã®è¡Œåˆ—ç©ã¯$\mathbf{AB}$ã¨æ›¸ã ã€$\mathbf{A}$ã®å„è¡Œã¨$\mathbf{B}$ã®å„åˆ—ã®å†…ç©ã‚’ä¸¦ã¹ãŸã‚‚ã®ã¨ã—ã¦å®šç¾©ã•ã‚Œã¾ã™ã€‚
# 
# ä¾‹ãˆã°ã€è¡Œåˆ—$\mathbf{A}$ã®$1$è¡Œç›®ã®è¡Œãƒ™ã‚¯ãƒˆãƒ«ã¨ã€è¡Œåˆ—$\mathbf{B}$ã®$1$åˆ—ç›®ã®åˆ—ãƒ™ã‚¯ãƒˆãƒ«ã®å†…ç©ã®çµæœã¯ã€$\mathbf{A}$ã¨$\mathbf{B}$ã®è¡Œåˆ—ç©ã®çµæœã‚’è¡¨ã™è¡Œåˆ—$\mathbf{C}$ã®$1$è¡Œ$1$åˆ—ç›®ã«å¯¾å¿œã—ã¾ã™ã€‚
# 
# ![](./Figure/matrix.png)
# 
# å†…ç©ãŒå®šç¾©ã•ã‚Œã‚‹æ¡ä»¶ã¯ãƒ™ã‚¯ãƒˆãƒ«ã®ã‚µã‚¤ã‚ºãŒç­‰ã—ã„ã¨ã„ã†ã“ã¨ã§ã—ãŸãŒã€ã“ã“ã§ã‚‚ãã‚ŒãŒæˆã‚Šç«‹ã¤ãŸã‚ã«ã€$\mathbf{A}$ã®è¡Œã®ã‚µã‚¤ã‚ºã¨ $\mathbf{B}$ ã®åˆ—ã®ã‚µã‚¤ã‚ºãŒä¸€è‡´ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚
# 
# ![](./Figure/matrix2.png)
# 
# #### è»¢ç½®
# è»¢ç½®ï¼ˆtransposeï¼‰ã¨ã¯ã€$m$ è¡Œ $n$ åˆ—ã®è¡Œåˆ— $\mathbf{A}$ ã«å¯¾ã—ã¦ã€ $\mathbf{A}$ ã® $(i, j)$ è¦ç´ ã¨ $(j, i)$ è¦ç´ ã‚’å…¥ã‚Œæ›¿ãˆã¦ã€$n$ è¡Œ $m$ åˆ—ã®è¡Œåˆ—ã«å¤‰æ›ã™ã‚‹æ“ä½œã§ã™ã€‚è»¢ç½®ã¯è¡Œåˆ—ã®å³è‚©ã«$T$ã¨æ›¸ãã“ã¨ã§è¡¨ã—ã¾ã™ã€‚
# 
# $$
# \begin{split}
# {\bf A} =\begin{bmatrix}
# 1 & 4 \\
# 2 & 5 \\
# 3 & 6
# \end{bmatrix}, \
# {\bf A}^{\rm T}=\begin{bmatrix}
# 1 & 2 & 3 \\
# 4 & 5 & 6
# \end{bmatrix}
# \end{split}
# $$
# 
# è»¢ç½®ã«ã¤ã„ã¦ã€ä»¥ä¸‹ã®å®šç†ã‚’è¦šãˆã¦ãŠãã¾ã—ã‚‡ã†ã€‚
# 
# $$
# \begin{split}\begin{aligned}
# &\left( 1\right) \ \left( {\bf A}^{\rm T} \right)^{\rm T} = {\bf A} \\
# &\left( 2\right) \ \left( {\bf A}{\bf B} \right)^{\rm T} = {\bf B}^{\rm T}{\bf A}^{\rm T}\\
# &\left( 3\right) \ \left( {\bf A}{\bf B}{\bf C} \right)^{\rm T} = {\bf C}^{\rm T}{\bf B}^{\rm T}{\bf A}^{\rm T}
# \end{aligned}\end{split}
# $$
# 
# ```{note}
# ã‚‚ã¡ã‚ã‚“ã€è»¢ç½®ã¯ãƒ™ã‚¯ãƒˆãƒ«ã«å¯¾ã—ã¦ã‚‚å®šç¾©ã§ãã¾ã™ã€‚è»¢ç½®ã‚’ç”¨ã„ã‚‹ã¨ã€ 2 ã¤ã®åˆ—ãƒ™ã‚¯ãƒˆãƒ«$ğ±$,$ğ²$ã®å†…ç©$ğ±\cdotğ²$ã¯ã€è¡Œåˆ—ç©ã‚’ç”¨ã„ã¦$x^T ğ²$ã¨æ›¸ã‘ã¾ã™ã€‚
# ```

# #### ãƒ™ã‚¯ãƒˆãƒ«ã«ã‚ˆã‚‹å¾®åˆ†ã¨å‹¾é…

# ç·šå½¢çµåˆã¨ã¯ã€ã‚¹ã‚«ãƒ©ãƒ¼å€ã—ãŸãƒ™ã‚¯ãƒˆãƒ«åŒå£«ã‚’è¶³ã—åˆã‚ã›ã‚‹ã“ã¨ã§ã™ã€‚ 
# 
# ä¾‹ãˆã°ã€
# 
# $$
# \begin{split}\begin{aligned}
# {\bf b}
# &=\begin{bmatrix}
# 3 \\
# 4
# \end{bmatrix}, \
# {\bf x} =
# \begin{bmatrix}
# x_{1} \\
# x_{2}
# \end{bmatrix}\\
# {\bf b}^{\rm T}{\bf x} &=
# \begin{bmatrix}
# 3 & 4
# \end{bmatrix}
# \begin{bmatrix}
# x_1 \\
# x_2
# \end{bmatrix}
# = 3x_1 + 4x_2
# \end{aligned}\end{split}
# $$
# 
# ã®ã‚ˆã†ã«$\mathbf{x}$ã®è¦ç´ ã§ã‚ã‚‹$x_1$ãŠã‚ˆã³$x_2$ã«é–¢ã—ã¦ä¸€æ¬¡å¼ã¨ãªã£ã¦ã„ã¾ã™ã€‚

# $\mathbf{ğ›^Tğ±}$ã‚’ãƒ™ã‚¯ãƒˆãƒ«$\mathbf{x}$ã§å¾®åˆ†ã—ãŸã‚‚ã®ã‚’ã€
# 
# $$
# \frac{\partial}{\partial {\bf x}} \left( {\bf b}^{\rm T}{\bf x} \right)
# $$
# 
# ã¨è¡¨ã—ã¾ã™ã€‚
# 
# ã€Œãƒ™ã‚¯ãƒˆãƒ«ã§å¾®åˆ†ã€ã¨ã¯ã€ãƒ™ã‚¯ãƒˆãƒ«ã®ãã‚Œãã‚Œã®è¦ç´ ã§å¯¾è±¡ã‚’å¾®åˆ†ã—ã€ãã®çµæœã‚’è¦ç´ ã«å¯¾å¿œã™ã‚‹ä½ç½®ã«ä¸¦ã¹ã¦ãƒ™ã‚¯ãƒˆãƒ«ã‚’ä½œã‚‹ã“ã¨ã§ã™ã€‚ã¤ã¾ã‚Šã€
# 
# $$
# \begin{split}
# \begin{aligned}
# \frac{\partial}{\partial {\bf x}} \left( {\bf b}^{\rm T} {\bf x} \right)
# &= \frac{\partial}{\partial {\bf x}} \left( 3x_1 + 4x_2 \right) \\
# &=
# \begin{bmatrix}
# \frac{\partial}{\partial x_1} \left( 3x_1 + 4x_2 \right) & \frac{\partial}{\partial x_2} \left( 3x_1 + 4x_2 \right)
# \end{bmatrix}
# \end{aligned}
# \end{split}
# =
# \begin{bmatrix}
# 3 & 4
# \end{bmatrix}
# $$

# å…¥åŠ›ãƒ™ã‚¯ãƒˆãƒ«ã®è¦ç´ æ¯ã«å‡ºåŠ›ã«å¯¾ã™ã‚‹åå¾®åˆ†ã‚’è¨ˆç®—ã—ã€ãã‚Œã‚‰ã‚’ä¸¦ã¹ã¦ãƒ™ã‚¯ãƒˆãƒ«ã«ã—ãŸã‚‚ã®ãŒ **<u>å‹¾é… (gradient)**</u> ã¨è¨€ã„ã¾ã™ã€‚
# 
# ã¤ã¾ã‚Šã€å¤šå¤‰æ•°é–¢æ•°ã«ãŠã‘ã‚‹å‚¾ãã®ã‚ˆã†ãªã‚‚ã®ã§ã€$1$å¤‰æ•°é–¢æ•°ã®ã‚ˆã†ã«ã‚¹ã‚«ãƒ©ãƒ¼ã§ã¯ãªãã€å‹¾é…ã§æœ€ã‚‚æ€¥ãªå¤‰åŒ–ã®æ–¹å‘ã¨ãã®å¤§ãã•ã‚’ç¤ºã—ã¦ã„ã¾ã™ã€‚å‹¾é…ãƒ™ã‚¯ãƒˆãƒ«ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«å®šç¾©ã•ã‚Œã¾ã™ï¼š
# 
# 
# $$
# \nabla f = \left( \frac{\partial f}{\partial x}, \frac{\partial f}{\partial y}, ... \right) \
# $$

# ã“ã“ã§ã€é–¢æ•°$f(x,y)=x^2+y^2$ã®å€¤ç­‰é«˜ç·šã¨ãã®å‹¾é…ã‚’åŒæ™‚ã«ãƒ—ãƒ­ãƒƒãƒˆã—ã¾ã™ã€‚èµ¤ã„çŸ¢å°ãŒå‹¾é…ãƒ™ã‚¯ãƒˆãƒ«ã‚’ç¤ºã—ã¦ãŠã‚Šã€å„ç‚¹ã§é–¢æ•°ã®æœ€ã‚‚æ€¥ãªä¸Šæ˜‡æ–¹å‘ã‚’æŒ‡ã—ç¤ºã—ã¦ã„ã¾ã™ã€‚
# 
# ```{margin}
# å‹¾é…ã¯ã€é–¢æ•°ã®å±€æ‰€çš„ãªå½¢çŠ¶ã‚„å¤‰åŒ–ã®æ–¹å‘ã‚’ç†è§£ã™ã‚‹ä¸Šã§éå¸¸ã«å½¹ç«‹ã¡ã¾ã™ã€‚ç‰¹ã«æ©Ÿæ¢°å­¦ç¿’ã‚„æœ€é©åŒ–ã®åˆ†é‡ã§ã¯ã€å‹¾é…é™ä¸‹æ³•ã¨ã„ã†ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ãŒé–¢æ•°ã®æœ€å°å€¤ã‚’æ±‚ã‚ã‚‹ãŸã‚ã«ä½¿ç”¨ã•ã‚Œã€ã“ã®å‹¾é…ã®æ¦‚å¿µãŒä¸­å¿ƒçš„ãªå½¹å‰²ã‚’æœãŸã—ã¦ã„ã¾ã™ã€‚
# ```

# In[8]:


import numpy as np
import matplotlib.pyplot as plt

# é–¢æ•°ã¨ãã®å‹¾é…
def function(x, y):
    return x**2 + y**2

def gradient(x, y):
    dfdx = 2*x
    dfdy = 2*y
    return dfdx, dfdy

# åº§æ¨™ã®ç”Ÿæˆ
x = np.linspace(-5, 5, 20)
y = np.linspace(-5, 5, 20)
X, Y = np.meshgrid(x, y)
Z = function(X, Y)
U, V = gradient(X, Y)

# å¯è¦–åŒ–
plt.figure(figsize=(10, 8))
plt.contour(X, Y, Z, levels=50, cmap='jet')  # é«˜åº¦ã‚’ç­‰é«˜ç·šã§è¡¨ç¤º
plt.quiver(X, Y, U, V, angles='xy', scale_units='xy', scale=10, color='red', width=0.005)  # å‹¾é…ãƒ™ã‚¯ãƒˆãƒ«ã‚’çŸ¢å°ã§è¡¨ç¤º
plt.axhline(0, color='black', linewidth=0.5)
plt.axvline(0, color='black', linewidth=0.5)
plt.title('Gradient of f(x, y) = x^2 + y^2')
plt.xlabel('x')
plt.ylabel('y')
plt.grid(True)
plt.show()


# In[ ]:




