Traceback (most recent call last):
  File "/opt/anaconda3/envs/jupyterbook/lib/python3.10/site-packages/jupyter_cache/executors/utils.py", line 51, in single_nb_execution
    executenb(
  File "/opt/anaconda3/envs/jupyterbook/lib/python3.10/site-packages/nbclient/client.py", line 1204, in execute
    return NotebookClient(nb=nb, resources=resources, km=km, **kwargs).execute()
  File "/opt/anaconda3/envs/jupyterbook/lib/python3.10/site-packages/nbclient/util.py", line 84, in wrapped
    return just_run(coro(*args, **kwargs))
  File "/opt/anaconda3/envs/jupyterbook/lib/python3.10/site-packages/nbclient/util.py", line 62, in just_run
    return loop.run_until_complete(coro)
  File "/opt/anaconda3/envs/jupyterbook/lib/python3.10/asyncio/base_events.py", line 649, in run_until_complete
    return future.result()
  File "/opt/anaconda3/envs/jupyterbook/lib/python3.10/site-packages/nbclient/client.py", line 663, in async_execute
    await self.async_execute_cell(
  File "/opt/anaconda3/envs/jupyterbook/lib/python3.10/site-packages/nbclient/client.py", line 965, in async_execute_cell
    await self._check_raise_for_error(cell, cell_index, exec_reply)
  File "/opt/anaconda3/envs/jupyterbook/lib/python3.10/site-packages/nbclient/client.py", line 862, in _check_raise_for_error
    raise CellExecutionError.from_cell_and_msg(cell, exec_reply_content)
nbclient.exceptions.CellExecutionError: An error occurred while executing the following cell:
------------------
# 順伝播
output, (hn, cn) = lstm(input, (h0, c0))
------------------

[0;31m---------------------------------------------------------------------------[0m
[0;31mRuntimeError[0m                              Traceback (most recent call last)
Cell [0;32mIn[4], line 2[0m
[1;32m      1[0m [38;5;66;03m# 順伝播[39;00m
[0;32m----> 2[0m output, (hn, cn) [38;5;241m=[39m [43mlstm[49m[43m([49m[38;5;28;43minput[39;49m[43m,[49m[43m [49m[43m([49m[43mh0[49m[43m,[49m[43m [49m[43mc0[49m[43m)[49m[43m)[49m

File [0;32m/opt/anaconda3/envs/jupyterbook/lib/python3.10/site-packages/torch/nn/modules/module.py:1518[0m, in [0;36mModule._wrapped_call_impl[0;34m(self, *args, **kwargs)[0m
[1;32m   1516[0m     [38;5;28;01mreturn[39;00m [38;5;28mself[39m[38;5;241m.[39m_compiled_call_impl([38;5;241m*[39margs, [38;5;241m*[39m[38;5;241m*[39mkwargs)  [38;5;66;03m# type: ignore[misc][39;00m
[1;32m   1517[0m [38;5;28;01melse[39;00m:
[0;32m-> 1518[0m     [38;5;28;01mreturn[39;00m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43m_call_impl[49m[43m([49m[38;5;241;43m*[39;49m[43margs[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mkwargs[49m[43m)[49m

File [0;32m/opt/anaconda3/envs/jupyterbook/lib/python3.10/site-packages/torch/nn/modules/module.py:1527[0m, in [0;36mModule._call_impl[0;34m(self, *args, **kwargs)[0m
[1;32m   1522[0m [38;5;66;03m# If we don't have any hooks, we want to skip the rest of the logic in[39;00m
[1;32m   1523[0m [38;5;66;03m# this function, and just call forward.[39;00m
[1;32m   1524[0m [38;5;28;01mif[39;00m [38;5;129;01mnot[39;00m ([38;5;28mself[39m[38;5;241m.[39m_backward_hooks [38;5;129;01mor[39;00m [38;5;28mself[39m[38;5;241m.[39m_backward_pre_hooks [38;5;129;01mor[39;00m [38;5;28mself[39m[38;5;241m.[39m_forward_hooks [38;5;129;01mor[39;00m [38;5;28mself[39m[38;5;241m.[39m_forward_pre_hooks
[1;32m   1525[0m         [38;5;129;01mor[39;00m _global_backward_pre_hooks [38;5;129;01mor[39;00m _global_backward_hooks
[1;32m   1526[0m         [38;5;129;01mor[39;00m _global_forward_hooks [38;5;129;01mor[39;00m _global_forward_pre_hooks):
[0;32m-> 1527[0m     [38;5;28;01mreturn[39;00m [43mforward_call[49m[43m([49m[38;5;241;43m*[39;49m[43margs[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mkwargs[49m[43m)[49m
[1;32m   1529[0m [38;5;28;01mtry[39;00m:
[1;32m   1530[0m     result [38;5;241m=[39m [38;5;28;01mNone[39;00m

File [0;32m/opt/anaconda3/envs/jupyterbook/lib/python3.10/site-packages/torch/nn/modules/rnn.py:875[0m, in [0;36mLSTM.forward[0;34m(self, input, hx)[0m
[1;32m    872[0m             hx [38;5;241m=[39m (hx[[38;5;241m0[39m][38;5;241m.[39munsqueeze([38;5;241m1[39m), hx[[38;5;241m1[39m][38;5;241m.[39munsqueeze([38;5;241m1[39m))
[1;32m    873[0m         [38;5;66;03m# Each batch of the hidden state should match the input sequence that[39;00m
[1;32m    874[0m         [38;5;66;03m# the user believes he/she is passing in.[39;00m
[0;32m--> 875[0m         [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mcheck_forward_args[49m[43m([49m[38;5;28;43minput[39;49m[43m,[49m[43m [49m[43mhx[49m[43m,[49m[43m [49m[43mbatch_sizes[49m[43m)[49m
[1;32m    876[0m         hx [38;5;241m=[39m [38;5;28mself[39m[38;5;241m.[39mpermute_hidden(hx, sorted_indices)
[1;32m    878[0m [38;5;28;01mif[39;00m batch_sizes [38;5;129;01mis[39;00m [38;5;28;01mNone[39;00m:

File [0;32m/opt/anaconda3/envs/jupyterbook/lib/python3.10/site-packages/torch/nn/modules/rnn.py:791[0m, in [0;36mLSTM.check_forward_args[0;34m(self, input, hidden, batch_sizes)[0m
[1;32m    785[0m [38;5;28;01mdef[39;00m [38;5;21mcheck_forward_args[39m([38;5;28mself[39m,  [38;5;66;03m# type: ignore[override][39;00m
[1;32m    786[0m                        [38;5;28minput[39m: Tensor,
[1;32m    787[0m                        hidden: Tuple[Tensor, Tensor],
[1;32m    788[0m                        batch_sizes: Optional[Tensor],
[1;32m    789[0m                        ):
[1;32m    790[0m     [38;5;28mself[39m[38;5;241m.[39mcheck_input([38;5;28minput[39m, batch_sizes)
[0;32m--> 791[0m     [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mcheck_hidden_size[49m[43m([49m[43mhidden[49m[43m[[49m[38;5;241;43m0[39;49m[43m][49m[43m,[49m[43m [49m[38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mget_expected_hidden_size[49m[43m([49m[38;5;28;43minput[39;49m[43m,[49m[43m [49m[43mbatch_sizes[49m[43m)[49m[43m,[49m
[1;32m    792[0m [43m                           [49m[38;5;124;43m'[39;49m[38;5;124;43mExpected hidden[0] size [39;49m[38;5;132;43;01m{}[39;49;00m[38;5;124;43m, got [39;49m[38;5;132;43;01m{}[39;49;00m[38;5;124;43m'[39;49m[43m)[49m
[1;32m    793[0m     [38;5;28mself[39m[38;5;241m.[39mcheck_hidden_size(hidden[[38;5;241m1[39m], [38;5;28mself[39m[38;5;241m.[39mget_expected_cell_size([38;5;28minput[39m, batch_sizes),
[1;32m    794[0m                            [38;5;124m'[39m[38;5;124mExpected hidden[1] size [39m[38;5;132;01m{}[39;00m[38;5;124m, got [39m[38;5;132;01m{}[39;00m[38;5;124m'[39m)

File [0;32m/opt/anaconda3/envs/jupyterbook/lib/python3.10/site-packages/torch/nn/modules/rnn.py:256[0m, in [0;36mRNNBase.check_hidden_size[0;34m(self, hx, expected_hidden_size, msg)[0m
[1;32m    253[0m [38;5;28;01mdef[39;00m [38;5;21mcheck_hidden_size[39m([38;5;28mself[39m, hx: Tensor, expected_hidden_size: Tuple[[38;5;28mint[39m, [38;5;28mint[39m, [38;5;28mint[39m],
[1;32m    254[0m                       msg: [38;5;28mstr[39m [38;5;241m=[39m [38;5;124m'[39m[38;5;124mExpected hidden size [39m[38;5;132;01m{}[39;00m[38;5;124m, got [39m[38;5;132;01m{}[39;00m[38;5;124m'[39m) [38;5;241m-[39m[38;5;241m>[39m [38;5;28;01mNone[39;00m:
[1;32m    255[0m     [38;5;28;01mif[39;00m hx[38;5;241m.[39msize() [38;5;241m!=[39m expected_hidden_size:
[0;32m--> 256[0m         [38;5;28;01mraise[39;00m [38;5;167;01mRuntimeError[39;00m(msg[38;5;241m.[39mformat(expected_hidden_size, [38;5;28mlist[39m(hx[38;5;241m.[39msize())))

[0;31mRuntimeError[0m: Expected hidden[0] size (2, 3, 20), got [1, 3, 20]
RuntimeError: Expected hidden[0] size (2, 3, 20), got [1, 3, 20]

